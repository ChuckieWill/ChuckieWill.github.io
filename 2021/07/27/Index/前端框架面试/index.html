<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="L231   Vue和 React越来越接近 Vue3 Options API 对应 React class Component Vue3 Composition API对应React Hooks">
<meta property="og:type" content="article">
<meta property="og:title" content="前端框架面试">
<meta property="og:url" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/index.html">
<meta property="og:site_name" content="Chuckie&#39;s Blog">
<meta property="og:description" content="L231   Vue和 React越来越接近 Vue3 Options API 对应 React class Component Vue3 Composition API对应React Hooks">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20220819132255475.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20220819142544786.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210808193254552.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210808193038819.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210808202413510.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210809104851066.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210809160820646.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210810182640295.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210810181939993.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20220824101337489.png">
<meta property="og:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20220824101239949.png">
<meta property="article:published_time" content="2021-07-27T02:43:17.000Z">
<meta property="article:modified_time" content="2024-09-18T15:06:07.544Z">
<meta property="article:author" content="Chuckie">
<meta property="article:tag" content="vue3">
<meta property="article:tag" content="React">
<meta property="article:tag" content="webpack">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20220819132255475.png">

<link rel="canonical" href="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>前端框架面试 | Chuckie's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Chuckie's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chuckie">
      <meta itemprop="description" content="Bright future">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chuckie's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          前端框架面试
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-27 10:43:17" itemprop="dateCreated datePublished" datetime="2021-07-27T10:43:17+08:00">2021-07-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-09-18 23:06:07" itemprop="dateModified" datetime="2024-09-18T23:06:07+08:00">2024-09-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Index/" itemprop="url" rel="index"><span itemprop="name">Index</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>77k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:10</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>L231</p>
</blockquote>
<ul>
<li>Vue和 React越来越接近<ul>
<li>Vue3 Options API 对应 React class Component</li>
<li>Vue3 Composition API对应React Hooks</li>
</ul>
</li>
</ul>
<blockquote>
<p>前端组件库</p>
<ul>
<li><p>React UI 组件库<br>Ant Design ：<a href="https://ant.design/" target="_blank" rel="noopener">https://ant.design/</a><br>React Bootstrap： <a href="https://react-bootstrap.github.io/" target="_blank" rel="noopener">https://react-bootstrap.github.io/</a><br>MATERIAL-UI ：  <a href="https://material-ui.com/" target="_blank" rel="noopener">https://material-ui.com/</a></p>
</li>
<li><p>Vue UI组件库</p>
<p>Element : <a href="https://element.eleme.io/#/zh-CN" target="_blank" rel="noopener">https://element.eleme.io/#/zh-CN</a><br>vant : <a href="https://youzan.github.io/vant/#/zh-C%E2%80%A6" target="_blank" rel="noopener">https://youzan.github.io/vant/#/zh-C%E2%80%A6</a><br>View UI :  <a href="https://www.iviewui.com/" target="_blank" rel="noopener">https://www.iviewui.com/</a></p>
</li>
<li><p>动画库<br>Animate.css ：  <a href="https://animate.style/" target="_blank" rel="noopener">https://animate.style/</a></p>
</li>
<li><p>常用效果组件<br>swiper ： <a href="https://www.swiper.com.cn/" target="_blank" rel="noopener">https://www.swiper.com.cn/</a><br>mescroll.js   <a href="http://www.mescroll.com/api.html" target="_blank" rel="noopener">http://www.mescroll.com/api.html</a></p>
</li>
<li><p>工具类轮子<br>lodash.js ：  <a href="https://www.lodashjs.com/" target="_blank" rel="noopener">https://www.lodashjs.com/</a><br>Day.js  ： <a href="https://dayjs.fenxianglu.cn/" target="_blank" rel="noopener">https://dayjs.fenxianglu.cn/</a><br>timeago.js ：  <a href="https://github.com/hustcc/timeago.js" target="_blank" rel="noopener">https://github.com/hustcc/timeago.js</a><br>echarts  ：  <a href="https://echarts.apache.org/zh/index.html" target="_blank" rel="noopener">https://echarts.apache.org/zh/index.html</a><br>Meditor.md  :  <a href="https://pandao.github.io/editor.md/" target="_blank" rel="noopener">https://pandao.github.io/editor.md/</a><br>validator.js :   <a href="https://github.com/validatorjs/validator.js" target="_blank" rel="noopener">https://github.com/validatorjs/validator.js</a></p>
</li>
<li><p>Vue工具类<br>vue-draggable ：  <a href="https://www.itxst.com/vue-draggable/tutorial.html" target="_blank" rel="noopener">https://www.itxst.com/vue-draggable/tutorial.html</a><br>vue-qr :   <a href="https://www.npmjs.com/package/vue-qr" target="_blank" rel="noopener">https://www.npmjs.com/package/vue-qr</a><br>vue-cropper :   <a href="https://github.com/xyxiao001/vue-cropper" target="_blank" rel="noopener">https://github.com/xyxiao001/vue-cropper</a><br>vue-lazyload :   <a href="https://www.npmjs.com/package/vue-lazyload" target="_blank" rel="noopener">https://www.npmjs.com/package/vue-lazyload</a><br>vue-simple-upload :   <a href="https://github.com/saivarunk/vue-simple-upload" target="_blank" rel="noopener">https://github.com/saivarunk/vue-simple-upload</a></p>
</li>
</ul>
</blockquote>
<h1 id="一、Vue"><a href="#一、Vue" class="headerlink" title="一、Vue"></a>一、Vue</h1><blockquote>
<p><a href="https://cn.vuejs.org/" target="_blank" rel="noopener">Vue官方文档</a></p>
<p><a href="https://v3.cn.vuejs.org/" target="_blank" rel="noopener">Vue3官方文档</a></p>
<p><a href="https://chuckiewill.github.io/2020/06/10/Vue/Vuejs/" target="_blank" rel="noopener">Chuckie’s Blog - Vue</a></p>
</blockquote>
<ul>
<li>v-show和v-if 的区别</li>
<li>为何v-for 中要用key</li>
<li>描述Vue 组件生命周期（有父子组件的情况)</li>
<li>vue 组件如何通讯</li>
<li>描述组件渲染和更新的过程</li>
<li>双向数据绑定v-model的实现原理</li>
</ul>
<h2 id="Vue使用"><a href="#Vue使用" class="headerlink" title="Vue使用"></a>Vue使用</h2><h3 id="Vue基础知识点"><a href="#Vue基础知识点" class="headerlink" title="Vue基础知识点"></a>Vue基础知识点</h3><ul>
<li>插值操作<ul>
<li>v-html :会有XSS风险，会覆盖子组件</li>
</ul>
</li>
<li>computed 和watch<ul>
<li>computed有缓存，data 不变则不会重新计算</li>
<li>watch 如何深度监听?</li>
<li>watch 监听引用类型，拿不到oldVal, 因为oldVal 和 val都是存储的引用地址，而引用地址是没有变化的只是引用的堆中的值类型发生了变化</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;input v-model&#x3D;&quot;name&quot;&#x2F;&gt;</span><br><span class="line">        &lt;input v-model&#x3D;&quot;info.city&quot;&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            name: &#39;双越&#39;,</span><br><span class="line">            info: &#123;</span><br><span class="line">                city: &#39;北京&#39;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        name(oldVal, val) &#123;</span><br><span class="line">            &#x2F;&#x2F; eslint-disable-next-line</span><br><span class="line">            console.log(&#39;watch name&#39;, oldVal, val) &#x2F;&#x2F; 值类型，可正常拿到 oldVal 和 val</span><br><span class="line">        &#125;,</span><br><span class="line">        info: &#123;</span><br><span class="line">            handler(oldVal, val) &#123;</span><br><span class="line">                &#x2F;&#x2F; eslint-disable-next-line</span><br><span class="line">                console.log(&#39;watch info&#39;, oldVal, val) &#x2F;&#x2F; 引用类型，拿不到 oldVal 。因为指针相同，此时已经指向了新的 val</span><br><span class="line">            &#125;,</span><br><span class="line">            deep: true &#x2F;&#x2F; 深度监听</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>class和style的绑定及使用</p>
</li>
<li><p>列表渲染，v-for</p>
<ul>
<li>v-if和v-for不能同时使用，因为是先执行v-for,再执行v-if，而生成的每一个子标签都要进行v-if判断就太耗费性能了</li>
</ul>
</li>
<li><p>事件</p>
<ul>
<li>event参数，自定义参数</li>
<li>事件修饰符，按键修饰符</li>
<li>【观察】事件被绑定到哪里?<ul>
<li>event的原型对象是DOM的原生事件</li>
<li>event 是原生的</li>
<li>事件被挂载到当前元素（@在哪个元素上，事件就挂在哪个元素上）</li>
<li>和 DOM 事件一样</li>
</ul>
</li>
<li><a href="https://cn.vuejs.org/v2/api/#v-on" target="_blank" rel="noopener">v-on修饰符</a></li>
<li><a href="https://cn.vuejs.org/v2/guide/events.html#%E6%8C%89%E9%94%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6" target="_blank" rel="noopener">v-on按键修饰符</a></li>
</ul>
</li>
<li><p><a href="https://cn.vuejs.org/v2/guide/forms.html" target="_blank" rel="noopener">表单</a></p>
<ul>
<li>v-model</li>
<li>常见表单项textarea checkbox radio select</li>
<li>修饰符lazy number trim</li>
</ul>
</li>
</ul>
<h3 id="Vue组件使用"><a href="#Vue组件使用" class="headerlink" title="Vue组件使用"></a>Vue组件使用</h3><h4 id="组件间通讯"><a href="#组件间通讯" class="headerlink" title="组件间通讯"></a>组件间通讯</h4><ul>
<li>props 和$emit</li>
<li>组件间通讯–自定义事件</li>
</ul>
<h4 id="组件生命周期"><a href="#组件生命周期" class="headerlink" title="组件生命周期"></a>组件生命周期</h4><ul>
<li><p>created和mounted的区别</p>
<ul>
<li>created是已经完成vue的实例化和初始化，但是页面还没有渲染</li>
<li>mounted是已经完成了页面的渲染</li>
</ul>
</li>
<li><p>beforeDestory中一般会做什么事情</p>
<ul>
<li>销毁定时任务</li>
<li>绑定的document或window事件需要销毁</li>
<li>销毁组件中自定义的全局事件</li>
</ul>
<p><code>this.$bus.$off(&#39;发出事件名&#39;, 函数名)   //函数名：需要取消事件监听的函数</code></p>
</li>
<li><p>父子组件生命周期调用顺序</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">父组件-beforeCreate</span><br><span class="line">父组件-created</span><br><span class="line">父组件-beforeMount</span><br><span class="line">子组件-beforeCreate</span><br><span class="line">子组件-created</span><br><span class="line">子组件-beforeMount</span><br><span class="line">子组件-mounted</span><br><span class="line">父组件-mounted</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">父组件 beforeUpdate</span><br><span class="line">子组件 beforeUpdate</span><br><span class="line">子组件 updated</span><br><span class="line">父组件 updated</span><br><span class="line"></span><br><span class="line">父组件 beforeDestroy</span><br><span class="line">子组件 beforeDestroy</span><br><span class="line">子组件 destroyed</span><br><span class="line">父组件 destroyed</span><br></pre></td></tr></table></figure>

<h3 id="Vue高级特性（重点）"><a href="#Vue高级特性（重点）" class="headerlink" title="Vue高级特性（重点）"></a>Vue高级特性（重点）</h3><h4 id="自定义v-model"><a href="#自定义v-model" class="headerlink" title="自定义v-model"></a><strong>自定义v-model</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;父组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;!-- 自定义 v-model --&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123;name&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">        &lt;CustomVModel v-model&#x3D;&quot;name&quot;&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import CustomVModel from &#39;.&#x2F;CustomVModel&#39;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">       CustomVModel</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            name: &#39;Chuckie&#39;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;子组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;!-- 例如：vue 颜色选择 --&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;text&quot;</span><br><span class="line">        :value&#x3D;&quot;text1&quot;</span><br><span class="line">        @input&#x3D;&quot;$emit(&#39;change1&#39;, $event.target.value)&quot;&#x2F;&#x2F;将更新后的值传给v-model的回调函数</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;!--</span><br><span class="line">        1. 上面的 input 使用了 :value 而不是 v-model</span><br><span class="line">        2. 上面的 change1 和 model.event1 要对应起来</span><br><span class="line">        3. text1 属性对应起来</span><br><span class="line">    --&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    model: &#123;</span><br><span class="line">        prop: &#39;text1&#39;, &#x2F;&#x2F; 对应 props text1</span><br><span class="line">        event: &#39;change1&#39; &#x2F;&#x2F;对应父组件中v-model默认处理绑定的函数</span><br><span class="line">    &#125;,</span><br><span class="line">    props: &#123;</span><br><span class="line">        text1: &#123;</span><br><span class="line">            type: String,</span><br><span class="line">            default() &#123;</span><br><span class="line">                return &#39;&#39;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>



<h4 id="nextTick"><a href="#nextTick" class="headerlink" title="$nextTick"></a><strong>$nextTick</strong></h4><ul>
<li>Vue是异步渲染（原理部分会详细讲解)</li>
<li>data改变之后，DOM不会立刻渲染</li>
<li>$nextTick 会在DOM渲染之后被触发，以获取最新DOM节点</li>
<li>注意<code>ref</code>和<code>this.$refs</code>的配合使用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;ul ref&#x3D;&quot;ul1&quot;&gt;</span><br><span class="line">        &lt;li v-for&#x3D;&quot;(item, index) in list&quot; :key&#x3D;&quot;index&quot;&gt;</span><br><span class="line">            &#123;&#123;item&#125;&#125;</span><br><span class="line">        &lt;&#x2F;li&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;addItem&quot;&gt;添加一项&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;app&#39;,</span><br><span class="line">  data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        list: [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addItem() &#123;</span><br><span class="line">        this.list.push(&#96;$&#123;Date.now()&#125;&#96;)</span><br><span class="line">        this.list.push(&#96;$&#123;Date.now()&#125;&#96;)</span><br><span class="line">        this.list.push(&#96;$&#123;Date.now()&#125;&#96;)</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 获取 DOM 元素</span><br><span class="line">        const ulElem &#x3D; this.$refs.ul1</span><br><span class="line">        &#x2F;&#x2F; eslint-disable-next-line</span><br><span class="line">        console.log( ulElem.childNodes.length ) &#x2F;&#x2F;------------- 分析点1 -------------</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 1. 异步渲染，$nextTick 待 DOM 渲染完再回调</span><br><span class="line">        &#x2F;&#x2F; 2. 页面渲染时会将 data 的修改做整合，多次 data 修改只会渲染一次，例如上面添加3个值，但只渲染了一次</span><br><span class="line">        this.$nextTick(() &#x3D;&gt; &#123;</span><br><span class="line">          &#x2F;&#x2F; 获取 DOM 元素</span><br><span class="line">          const ulElem &#x3D; this.$refs.ul1</span><br><span class="line">          &#x2F;&#x2F; eslint-disable-next-line</span><br><span class="line">          console.log( ulElem.childNodes.length )&#x2F;&#x2F;------------- 分析点2 -------------</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&#x2F;&#x2F;分析点1</span><br><span class="line">第一次执行输出3  </span><br><span class="line">虽然data已经更新，此时list添加了3个值，长度应该是6</span><br><span class="line">但是渲染是异步的，此时页面还没有渲染就执行到了分析点1的位置</span><br><span class="line">所以此时拿到的是还没渲染之前的dom结构，所以长度是3</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;分析点2</span><br><span class="line">第一次执行输出6</span><br><span class="line">因为是分析点2的代码在$nextTick的回调函数里</span><br><span class="line">而$nextTick的回调函数在页面渲染后才会调用</span><br><span class="line">所以此时拿到的dom结构时更新后的dom,及data的更新已经渲染到页面，所以长度为6</span><br></pre></td></tr></table></figure>



<h4 id="slot"><a href="#slot" class="headerlink" title="slot"></a><strong>slot</strong></h4><ul>
<li>作用域插槽</li>
<li>具名插槽</li>
</ul>
<h4 id="动态、异步组件"><a href="#动态、异步组件" class="headerlink" title="动态、异步组件"></a><strong>动态、异步组件</strong></h4><ul>
<li>动态组件应用场景<ul>
<li>新闻详情页，不确定新闻是文本还是图片还是视频，文本图片视频的结构也不清楚</li>
<li>拿到的数据给定了新闻的文本图片视频的展示情况</li>
<li>根据具体的展示情况在渲染对应的文本组件或图片组件或视频组件</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;!-- 动态组件 --&gt;</span><br><span class="line">        &lt;component :is&#x3D;&quot;NextTickName&quot;&#x2F;&gt;&lt;!-- 此处渲染NextTick组件 --&gt;</span><br><span class="line">        &lt;div v-for&#x3D;&quot; ( val, key) in newsData&quot; :key&#x3D;&quot;key&quot;&gt;</span><br><span class="line">          &lt;component :is&#x3D;&quot;val.type&quot;&#x2F;&gt; &lt;!-- 此处渲染2个Text组件1个Image组件1个Viedo组件 --&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import NextTick from &#39;.&#x2F;NextTick</span><br><span class="line">import Text from &#39;.&#x2F;Text</span><br><span class="line">import Image from &#39;.&#x2F;Image</span><br><span class="line">import Video from &#39;.&#x2F;Video</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">        NextTick,</span><br><span class="line">        Text,</span><br><span class="line">        Image,</span><br><span class="line">        Video</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            NextTickName: &quot;NextTick&quot;,</span><br><span class="line">            newsData: &#123;  &#x2F;&#x2F;新闻数据，给定了现有2个文本，再有一个图片，再有一个视频</span><br><span class="line">              1:&#123;</span><br><span class="line">                type: &#39;Text&#39; </span><br><span class="line">              &#125;,</span><br><span class="line">              2: &#123;</span><br><span class="line">                type: &#39;Text&#39;</span><br><span class="line">              &#125;,</span><br><span class="line">              3:&#123;</span><br><span class="line">                type: &#39;Image&#39;</span><br><span class="line">              &#125;,</span><br><span class="line">              4:&#123;</span><br><span class="line">                type: &#39;Video&#39;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>异步组件<ul>
<li>异步组件就是异步加载（在项目打包时，一般的组件都是同步加载的）</li>
<li>使用场景：某个组件体积很大，且不一定在一开始加载就需要使用，则可以在使用时再引入</li>
<li>使用：引入方式不同</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//同步引入</span></span><br><span class="line"><span class="keyword">import</span> FormDemo <span class="keyword">from</span> <span class="string">' ../BaseUse/FormDemo '</span>  <span class="comment">//加载时即引入</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">        FormDemo</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//异步引入</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">        FormDemo: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">' ../BaseUse/FormDemo'</span>)<span class="comment">//页面需要使用该组件时再引入</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a><strong>keep-alive</strong></h4><ul>
<li><p>缓存组件</p>
<blockquote>
<p>常见使用场景：tab切换控制的组件</p>
</blockquote>
<ul>
<li>如果没有<code>keep-alive</code>的包裹，则组件在不显示（v-if判断为false）时就会销毁，再次显示时需要再次加载，这样就会耗费性能</li>
<li>如果有<code>keep-alive</code>的包裹，则组件在不显示时并不会销毁，会缓存下来，再次显示时直接使用</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive&gt; &lt;!-- tab 切换 --&gt;</span><br><span class="line">     &lt;KeepAliveStageA v-if&#x3D;&quot;state &#x3D;&#x3D;&#x3D; &#39;A&#39;&quot;&#x2F;&gt; &lt;!-- v-show --&gt;</span><br><span class="line">     &lt;KeepAliveStageB v-if&#x3D;&quot;state &#x3D;&#x3D;&#x3D; &#39;B&#39;&quot;&#x2F;&gt;</span><br><span class="line">     &lt;KeepAliveStageC v-if&#x3D;&quot;state &#x3D;&#x3D;&#x3D; &#39;C&#39;&quot;&#x2F;&gt;</span><br><span class="line"> &lt;&#x2F;keep-alive&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>v-if：<ul>
<li>属于条件显示，满足条件就显示元素，不满足就删除元素，<strong>通过操作DOM元素完成</strong>。</li>
<li>v-if的<strong>首次渲染显示的开销较小</strong>，因为它只渲染满足条件的那一个元素，<strong>切换组件时开销较大</strong>，因为它每切换以此就要重新触发生命周期渲染显示新元素</li>
<li>v-if值为false时，会将该元素节点从DOM树中删除，也就是会删除它的依赖、事件监听等。</li>
</ul>
</li>
<li>v-show：<ul>
<li>原理是<strong>通过控制元素的display属性来决定是否显示元素</strong>，属于响应式的。</li>
<li><strong>首次渲染的开销较大</strong>，因为它会将所有页面全部渲染好之后，在由display属性来决定显示谁。<strong>切换开销较小</strong>，因为已经全部全然完成，只需要改display属性便可以显示。</li>
<li>适用于：小组件的切换</li>
</ul>
</li>
<li>keep-alive：<ul>
<li>用于缓存活动组件，一开始并不会渲染全部组件，而是会渲染需要显示的组件，当切换组件时，会把之前已经渲染的组件缓存，每一次切换都会缓存该组件。缓存时通过vue框架的js层面实现的。</li>
<li>属于按需渲染实现，所以它的<strong>切换开销和首次渲染开销都较小</strong></li>
<li>适用于：大组件的切换，例如tab组件的切换</li>
</ul>
</li>
<li>v-show和keep-alive的区别<ul>
<li>渲染机制不同<ul>
<li>v-show是首次全部渲染完成，首次渲染的开销较大，切换开销较小</li>
<li>keep-alive是按需渲染，使用时才渲染，首次渲染开销和切换开销都较小</li>
</ul>
</li>
<li>实现方式不同<ul>
<li>v-show是css控制</li>
<li>keep-alive是vue框架实现的缓存</li>
</ul>
</li>
<li>相同点<ul>
<li>都不会触发组件的重新渲染，不会操作dom</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="mixin（混入）"><a href="#mixin（混入）" class="headerlink" title="mixin（混入）"></a><strong>mixin（混入）</strong></h4><blockquote>
<p><a href="https://cn.vuejs.org/v2/guide/mixins.html" target="_blank" rel="noopener">mixin官方教程-vue2.x</a></p>
<p>混入提供了一种将组件中共有的部分抽离实现可复用的功能。</p>
<p>组件中的任何部分都可抽离（data,methods,生命周期函数等）</p>
</blockquote>
<ul>
<li>mixin的使用场景：<ul>
<li>多个组件有相同的逻辑，抽离出来</li>
</ul>
</li>
<li>mixin的问题（Vue 3提出的Composition API旨在解决这些问题）<ul>
<li>变量来源不明确，不利于阅读</li>
<li>多mixin可能会造成命名冲突</li>
<li>mixin和组件可能出现多对多的关系，复杂度较高</li>
</ul>
</li>
<li>合并策略<ul>
<li>组件data,methods优先级高于mixin data,methods优先级<ul>
<li>值为对象的选项，例如 <code>methods</code>、<code>components</code> 和 <code>directives</code>，将被合并为同一个对象。两个对象键名冲突时，取组件对象的键值对。</li>
<li>数据对象在内部会进行递归合并，并在发生冲突时以组件数据优先</li>
</ul>
</li>
<li>生命周期函数，先执行mixin里面的，再执行组件里面的<ul>
<li>同名钩子函数将合并为一个数组，因此都将被调用。另外，混入对象的钩子将在组件自身钩子<strong>之前</strong>调用。</li>
</ul>
</li>
<li>自定义的属性，组件中的属性优先级高于 mixin 属性的优先级</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mixin.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    .......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;mixin的使用</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import myMixin from &#39;.&#x2F;mixin&#39;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    mixins: [myMixin], &#x2F;&#x2F; 可以添加多个，会自动合并起来</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>全局mixin<ul>
<li>所有组件不需要mixin关键字注册，即可全部默认引入</li>
<li>组件需要使用全局mixin的属性直接使用即可</li>
<li>不推荐使用，维护性不高，耦合性太高</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.mixin(&#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    .......</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>自定义属性的混入<ul>
<li>通过<code>this.$options</code>拿到自定义属性</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>lesson 28<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/vue@next"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">  <span class="comment">// 自定义的属性，组件种的属性优先级高于 mixin 属性的优先级</span></span></span><br><span class="line"><span class="actionscript">  <span class="keyword">const</span> myMixin = &#123;</span></span><br><span class="line"><span class="actionscript">    number: <span class="number">1</span>  <span class="comment">//自定义属性</span></span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">  <span class="keyword">const</span> app = Vue.createApp(&#123;</span></span><br><span class="line">    mixins: [myMixin],</span><br><span class="line"><span class="actionscript">    number: <span class="number">2</span>,<span class="comment">//自定义属性（不是在data中定义）</span></span></span><br><span class="line">    template: `</span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;&#123;this.$options.number&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line">    `</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line"><span class="actionscript">  <span class="comment">//修改默认的自定义属性混入优先级</span></span></span><br><span class="line"><span class="actionscript">  <span class="comment">//默认组件自定义属性优先级&gt;mixin自定义属性优先级</span></span></span><br><span class="line"><span class="actionscript">  <span class="comment">//下面的修改后    默认组件自定义属性优先级 &lt; mixin自定义属性优先级</span></span></span><br><span class="line"><span class="javascript">  app.config.optionMergeStrategies.number = <span class="function">(<span class="params">mixinVal, appValue</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">return</span> mixinVal || appValue;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">  <span class="keyword">const</span> vm = app.mount(<span class="string">'#root'</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="Vuex-待完成"><a href="#Vuex-待完成" class="headerlink" title="Vuex 待完成"></a>Vuex 待完成</h3><blockquote>
<p><a href="https://vuex.vuejs.org/zh/" target="_blank" rel="noopener">Vuex官网</a></p>
<p>面试考点主要是state的设计</p>
</blockquote>
<ul>
<li>基本概念<ul>
<li>State</li>
<li>Getter</li>
<li>Mutation</li>
<li>Action</li>
<li>Module</li>
</ul>
</li>
<li>组件中使用<ul>
<li>访问 State 和 Getter<ul>
<li>为了访问 state 和 getter，需要创建 <code>computed</code> 引用以保留响应性，这与在选项式 API 中创建计算属性等效。</li>
</ul>
</li>
<li>访问 Mutation 和 Action<ul>
<li>要使用 mutation 和 action 时，只需要在 <code>setup</code> 钩子函数中调用 <code>commit</code> 和 <code>dispatch</code> 函数。</li>
</ul>
</li>
</ul>
</li>
<li>state的设计（待完成）</li>
</ul>
<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20220819132255475.png" alt="image-20220819132255475"></p>
<h3 id="Vue-router"><a href="#Vue-router" class="headerlink" title="Vue-router"></a>Vue-router</h3><ul>
<li><p>路由模式( hash、H5 history )</p>
</li>
<li><p>路由配置(动态路由、懒加载)</p>
<ul>
<li>动态路由是指可以在路径中携带参数</li>
<li>懒加载是指异步加载</li>
</ul>
</li>
<li><p>Vue-router路由模式</p>
<ul>
<li>hash模式(默认) ,如<code>http://abc.com/#/user/10</code></li>
<li>H5 history模式,如<code>http://abc.com/user/20</code>    <ul>
<li>需要server端支持，因此无特殊需求可选择前者</li>
<li><a href="https://router.vuejs.org/zh/guide/essentials/history-mode.html" target="_blank" rel="noopener">后端支持的原因和使用官方教程</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 路由设置为history</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = createRouter(&#123;</span><br><span class="line">  history: createWebHistory(),</span><br><span class="line">  routes: [</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  ],</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h2 id="Vue原理"><a href="#Vue原理" class="headerlink" title="Vue原理"></a>Vue原理</h2><h3 id="组件化"><a href="#组件化" class="headerlink" title="组件化"></a>组件化</h3><h4 id="数据驱动视图"><a href="#数据驱动视图" class="headerlink" title="数据驱动视图"></a>数据驱动视图</h4><ul>
<li>传统组件,只是静态渲染,更新还要依赖于操作DOM，</li>
<li>数据驱动视图- Vue MVVM， 不再需要操作DOM,更新数据即可使页面更新并渲染</li>
<li>数据驱动视图- React setState ，不再需要操作DOM,更新数据即可使页面更新并渲染</li>
</ul>
<h4 id="Vue中的MVVM"><a href="#Vue中的MVVM" class="headerlink" title="Vue中的MVVM"></a>Vue中的MVVM</h4><ul>
<li>数据修改vue就可以实现自动驱动页面的渲染</li>
<li>不用开发者去操作DOM，可以专注于业务的开发，实现更复杂的功能</li>
</ul>
<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20220819142544786.png" alt="image-20220819142544786"></p>
<h3 id="响应式"><a href="#响应式" class="headerlink" title="响应式"></a>响应式</h3><blockquote>
<p> 组件data的数据一旦变化,立刻触发视图的更新</p>
<p> <a href="https://www.jianshu.com/p/07ba2b0c8fca/" target="_blank" rel="noopener">vue.js关于Object.defineProperty的利用原理</a></p>
<p> <a href="https://blog.csdn.net/weixin_46726346/article/details/115913752" target="_blank" rel="noopener">Object.defineProperty方法（详解）</a></p>
</blockquote>
<ul>
<li>实现响应式的核心API —— <strong>Object.defineProperty</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Object.defineProperty基本使用</span></span><br><span class="line"><span class="comment">// 案例1 属性本身没有</span></span><br><span class="line"><span class="keyword">const</span> data = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> name1 =<span class="string">'zhangsan'</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(data,<span class="string">'name'</span>, &#123;  <span class="comment">//name表示在对象data上添加属性，属性名为name</span></span><br><span class="line">  <span class="keyword">get</span>: function () &#123; </span><br><span class="line">    <span class="built_in">console</span>.log( <span class="string">'get'</span>) </span><br><span class="line">    <span class="keyword">return</span> name1 <span class="comment">// 不是data.name  而是外部在通过data.name访问时，返回name1的值</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">set</span>: function (newVal) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'set'</span>)</span><br><span class="line">    name1 = newVal  <span class="comment">// data.name 实际存储的位置</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="built_in">console</span>.log(data.name) <span class="comment">//打印 get  zhangsan</span></span><br><span class="line">data.name = <span class="string">'lisi'</span>  <span class="comment">//打印 set</span></span><br><span class="line"><span class="built_in">console</span>.log(data.name) <span class="comment">//打印 get  lisi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 案例2 属性本身存在</span></span><br><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">  name: <span class="string">'zhangsan'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observer</span>(<span class="params">data,key,value</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(data,<span class="string">'name'</span>, &#123; </span><br><span class="line">    <span class="keyword">get</span>: function () &#123; </span><br><span class="line">      <span class="built_in">console</span>.log( <span class="string">'get'</span>)</span><br><span class="line">      <span class="keyword">return</span> value    <span class="comment">// 指定data.name 获取的值</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>: function (newVal) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'set'</span>)</span><br><span class="line">      value = newVal <span class="comment">// newVal赋值给value后，value再赋值给data.name  从而实现对data.name的修改  避免形成zi'di</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">observer(data,<span class="string">'name'</span>,data.name)</span><br><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="built_in">console</span>.log(data.name) <span class="comment">//打印 get  zhangsan</span></span><br><span class="line">data.name = <span class="string">'lisi'</span>  <span class="comment">//打印 set</span></span><br><span class="line"><span class="built_in">console</span>.log(data.name) <span class="comment">//打印 get  lisi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误案例</span></span><br><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">  name: <span class="string">'zhangsan'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(data,<span class="string">'name'</span>, &#123; </span><br><span class="line">  <span class="keyword">get</span>: function () &#123; </span><br><span class="line">    <span class="built_in">console</span>.log( <span class="string">'get'</span>)</span><br><span class="line">    <span class="keyword">return</span> data.name</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">set</span>: function (newVal) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'set'</span>)</span><br><span class="line">    data.name = newVal</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="built_in">console</span>.log(data.name) <span class="comment">//一直打印get  因为get函数中又执行了data.name, 无限循环的执行data.name, 无限循环的打印get</span></span><br><span class="line">data.name = <span class="string">'lisi'</span>  <span class="comment">//执行不到这里</span></span><br><span class="line"><span class="built_in">console</span>.log(data.name) <span class="comment">//执行不到这里</span></span><br></pre></td></tr></table></figure>



<ul>
<li>深度监听data变化及监听数组变化<ul>
<li>深度监听data变化用到了递归的方式</li>
<li>监听数组变化主要是对数组原生方法对数组的修改做到了监听</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 触发更新视图</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateView</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'视图更新-Object.defineProperty监听'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 触发更新视图</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateViewArray</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'视图更新-数组原生方法监听'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重新定义数组原型</span></span><br><span class="line"><span class="keyword">const</span> oldArrayProperty = <span class="built_in">Array</span>.prototype</span><br><span class="line"><span class="comment">// 创建新对象，原型指向 oldArrayProperty ，再扩展新的方法不会影响原型</span></span><br><span class="line"><span class="keyword">const</span> arrProto = <span class="built_in">Object</span>.create(oldArrayProperty);</span><br><span class="line">[<span class="string">'push'</span>, <span class="string">'pop'</span>, <span class="string">'shift'</span>, <span class="string">'unshift'</span>, <span class="string">'splice'</span>].forEach(<span class="function"><span class="params">methodName</span> =&gt;</span> &#123;</span><br><span class="line">    arrProto[methodName] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        updateViewArray() <span class="comment">// 触发视图更新</span></span><br><span class="line">        oldArrayProperty[methodName].call(<span class="keyword">this</span>, ...arguments)</span><br><span class="line">        <span class="comment">// Array.prototype.push.call(this, ...arguments)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重新定义属性，监听起来</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span>(<span class="params">target, key, value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 深度监听</span></span><br><span class="line">    observer(value)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 核心 API</span></span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(target, key, &#123;</span><br><span class="line">        <span class="keyword">get</span>() &#123;</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">set</span>(newValue) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newValue !== value) &#123;</span><br><span class="line">                <span class="comment">// 深度监听</span></span><br><span class="line">                observer(newValue)</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 设置新值</span></span><br><span class="line">                <span class="comment">// 注意，value 一直在闭包中，此处设置完之后，再 get 时也是会获取最新的值</span></span><br><span class="line">                value = newValue</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 触发更新视图</span></span><br><span class="line">                updateView()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听对象属性</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observer</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> target !== <span class="string">'object'</span> || target === <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// 不是对象或数组</span></span><br><span class="line">        <span class="keyword">return</span> target</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 污染全局的 Array 原型</span></span><br><span class="line">    <span class="comment">// Array.prototype.push = function () &#123;</span></span><br><span class="line">    <span class="comment">//     updateView()</span></span><br><span class="line">    <span class="comment">//     ...</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(target)) &#123;</span><br><span class="line">        target.__proto__ = arrProto</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 重新定义各个属性（for in 也可以遍历数组）</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> target) &#123;</span><br><span class="line">        defineReactive(target, key, target[key])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 准备数据</span></span><br><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">    name: <span class="string">'zhangsan'</span>,</span><br><span class="line">    age: <span class="number">20</span>,</span><br><span class="line">    info: &#123;</span><br><span class="line">        address: <span class="string">'北京'</span> <span class="comment">// 需要深度监听</span></span><br><span class="line">    &#125;,</span><br><span class="line">    nums: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听数据</span></span><br><span class="line">observer(data)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试</span></span><br><span class="line"><span class="comment">// data.name = 'lisi'</span></span><br><span class="line"><span class="comment">// data.age = 21</span></span><br><span class="line"><span class="comment">// data.age = &#123;num: 22&#125;   // 设置新值需要深度监听的案例</span></span><br><span class="line"><span class="comment">// console.log('age', data.age.num)</span></span><br><span class="line"><span class="comment">// data.x = '100' // 新增属性，监听不到 —— 所以有 Vue.set</span></span><br><span class="line"><span class="comment">// delete data.name // 删除属性，监听不到 —— 所以有 Vue.delete</span></span><br><span class="line"><span class="comment">// data.info.address = '上海' // 深度监听</span></span><br><span class="line">data.nums.push(<span class="number">4</span>) <span class="comment">// 特殊处理的方式监听数组</span></span><br><span class="line"><span class="built_in">console</span>.log(data.nums)</span><br><span class="line">data.nums = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>] <span class="comment">// Object.defineProperty的方式监听数组</span></span><br><span class="line"><span class="built_in">console</span>.log(data.nums)<span class="comment">// 打印结果[1,2,1000,4] 因为后面对nums[2]做了修改，而数组是堆栈存储，存储的是同一个位置所以会影响</span></span><br><span class="line">data.nums[<span class="number">2</span>] = <span class="number">1000</span> <span class="comment">// Object.defineProperty的方式监听数组</span></span><br><span class="line"><span class="built_in">console</span>.log(data.nums) <span class="comment">// 打印结果[1,2,1000,4]</span></span><br></pre></td></tr></table></figure>



<ul>
<li>Object.defineProperty的一些缺点( Vue3.0启用Proxy )<ul>
<li>深度监听，需要递归到底，一次性计算量大</li>
<li>无法监听新增属性/删除属性(用Vue.set和 Vue.delete专门来处理新增和删除属性的响应式 )</li>
<li>无法原生监听数组，需要特殊处理，<ul>
<li>即原生数组的方法（push、pop、shift等等）对数组的修改无法通过Object.defineProperty监听到，所以需要对这些原生方法做特殊处理，</li>
<li>通过索引对数组的修改可以通过Object.defineProperty监听到                                                                                                                                                                                                                                                                                                                                                                                    </li>
</ul>
</li>
</ul>
</li>
<li>Proxy有兼容性问题，Proxy兼容性不好,且无法polyfill</li>
</ul>
<h3 id="虚拟DOM和diff"><a href="#虚拟DOM和diff" class="headerlink" title="虚拟DOM和diff"></a>虚拟DOM和diff</h3><h4 id="虚拟DOM"><a href="#虚拟DOM" class="headerlink" title="虚拟DOM"></a><strong>虚拟DOM</strong></h4><p><strong>虚拟DOM的解决方案:</strong></p>
<ul>
<li><p>用JS模拟DOM结构，计算出最小的变更（最小单元需要修改的dom），操作DOM</p>
</li>
<li><p>用js的原因：js的计算远快于dom更新</p>
</li>
</ul>
<p><strong>用JS模拟DOM结构：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span> <span class="attr">class</span>=<span class="string">container</span>""&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>vdom<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">style</span>=<span class="string">"font-size: 20px"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>a<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用vnode模拟上面的html片段 </span></span><br><span class="line">&#123;</span><br><span class="line">    tag:<span class="string">'div'</span>,</span><br><span class="line">    props:&#123;</span><br><span class="line">        id: <span class="string">'div1'</span>,</span><br><span class="line">        className: <span class="string">'container'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    children:[</span><br><span class="line">       &#123;</span><br><span class="line">           tag: <span class="string">'p'</span>,</span><br><span class="line">           chuildren:<span class="string">'vdom'</span></span><br><span class="line">       &#125;,</span><br><span class="line">       &#123;</span><br><span class="line">           tag: <span class="string">'ul'</span>,</span><br><span class="line">           props:&#123;</span><br><span class="line">               sytle: <span class="string">'font-size: 20px'</span></span><br><span class="line">           &#125;,</span><br><span class="line">           children: [</span><br><span class="line">               tag: <span class="string">'li'</span>,</span><br><span class="line">               children: <span class="string">'a'</span></span><br><span class="line">           ]</span><br><span class="line">       &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>通过snabbdom学习vdom：</strong></p>
<blockquote>
<p><a href="https://github.com/snabbdom/snabbdom" target="_blank" rel="noopener">snabbdom英文文档</a></p>
<p><a href="https://github.com/coconilu/Blog/issues/152" target="_blank" rel="noopener">snabbdom中文文档</a></p>
<p><a href="https://github.com/snabbdom/snabbdom" target="_blank" rel="noopener">snabbdom-github</a></p>
<ul>
<li>简洁强大的vdom库，易学易用</li>
<li>Vue参考它实现的vdom和diff</li>
<li>Vue3.0重写了vdom的代码，优化了性能</li>
</ul>
</blockquote>
<ul>
<li>安装及使用 <ul>
<li>安装snabbdom：<code>npm i snabbdom</code></li>
<li>使用snabbdom: 官方文档有案例</li>
</ul>
</li>
<li>snabbdom核心内容<ul>
<li>h函数</li>
<li>vnode数据结构  </li>
<li>patch函数 （比对新旧vnode就是用的diff算法）</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//h函数的返回值就是vnode结构</span></span><br><span class="line"><span class="comment">// sel: 标签   data:属性  children: 子节点</span></span><br><span class="line"><span class="keyword">let</span> vnode = h(<span class="string">'sel'</span>, &#123;data&#125;, [children])</span><br><span class="line"></span><br><span class="line"><span class="comment">// sel: div标签，并有id=container, class=two, classes</span></span><br><span class="line"><span class="comment">// data: on（事件属性），click（事件类型）</span></span><br><span class="line"><span class="comment">// children: 可以是数组，数组元素是也是h函数返回的vnode,也可以是text类型的内容</span></span><br><span class="line"><span class="keyword">const</span> vnode = h(<span class="string">"div#container.two.classes"</span>, &#123; <span class="attr">on</span>: &#123; <span class="attr">click</span>: someFn &#125; &#125;, [</span><br><span class="line">  h(<span class="string">"span"</span>, &#123; <span class="attr">style</span>: &#123; <span class="attr">fontWeight</span>: <span class="string">"bold"</span> &#125; &#125;, <span class="string">"This is bold"</span>),</span><br><span class="line">  <span class="string">" and this is just normal text"</span>,</span><br><span class="line">  h(<span class="string">"a"</span>, &#123; <span class="attr">props</span>: &#123; <span class="attr">href</span>: <span class="string">"/foo"</span> &#125; &#125;, <span class="string">"I'll take you places!"</span>),</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> container = <span class="built_in">document</span>.getElementById(<span class="string">"container"</span>)</span><br><span class="line"><span class="comment">//初始化，第一次执行render函数生成最初的vnode结构，并用它替换container容器的内容</span></span><br><span class="line">patch(container, vnode)</span><br><span class="line"><span class="comment">//更新vdom， 数据变化触发响应式，重新执行render函数生成新的newVnode, 比较newVnode和vnode，计算最小的变更，并更新dom</span></span><br><span class="line">patch(vnode, newVnode)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//vnode结构</span></span><br><span class="line"><span class="comment">// sel: 标签   data:属性  children: 子节点 , text: 没有子节点，只有文本内容，</span></span><br><span class="line"><span class="comment">// elm: 这个vnode对应的实际dom标签, key: 循环体中传入的key, 若没有传则是undefine</span></span><br><span class="line">&#123; sel, data, children, text, elm, key &#125;</span><br></pre></td></tr></table></figure>



<p><strong>vdom总结</strong></p>
<ul>
<li>用JS模拟DOM结构(vnode)</li>
<li>新旧vnode对比,<strong>得出最小的更新范围</strong>,最后更新DOM</li>
<li>数据驱动视图的模式下, 有效控制DOM操作</li>
<li>jQuery的更新是整体页面刷新，但是<strong>vdom只更新需要更新的局部地方</strong>，效率更高<ul>
<li>下面使用snabbdom构建例子解释</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义 h</span></span><br><span class="line"><span class="keyword">const</span> h = snabbdom.h</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> container = <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成 vnode</span></span><br><span class="line"><span class="keyword">const</span> vnode = h(<span class="string">'ul#list'</span>, &#123;&#125;, [</span><br><span class="line">    h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'Item 1'</span>),</span><br><span class="line">    h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'Item 2'</span>)</span><br><span class="line">])</span><br><span class="line">patch(container, vnode)</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'btn-change'</span>).addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 生成 newVnode</span></span><br><span class="line">    <span class="keyword">const</span> newVnode = h(<span class="string">'ul#list'</span>, &#123;&#125;, [</span><br><span class="line">        h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'Item 1'</span>), <span class="comment">// 更新时计算出该节点没有变化，所以不会操作该节点DOM</span></span><br><span class="line">        h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'Item B'</span>), <span class="comment">// 更新时计算出该节点有变化(局部)，所以会操作该节点DOM</span></span><br><span class="line">        h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'Item 3'</span>)  <span class="comment">// 更新时计算出该节点有变化(局部)，所以会操作该节点DOM</span></span><br><span class="line">    ])</span><br><span class="line">    patch(vnode, newVnode)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// vnode = newVnode // patch 之后，应该用新的覆盖现有的 vnode ，否则每次 change 都是新旧对比</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h4 id="diff算法"><a href="#diff算法" class="headerlink" title="diff算法"></a><strong>diff算法</strong></h4><blockquote>
<p><a href="https://github.com/cujojs/jiff" target="_blank" rel="noopener">比较两个对象的diff算法-github</a></p>
</blockquote>
<p><strong>diff算法概述</strong></p>
<ul>
<li>树diff的时间复杂度O(n^3)<ul>
<li>第一，遍历tree1 ;</li>
<li>第二, 遍历tree2</li>
<li>第三, 排序</li>
</ul>
</li>
<li>优化时间复杂度到O(n)<ul>
<li>只比较同一层级,不跨级比较<ul>
<li>树结构的同层级比较，是线性比较，时间复杂度O(n)</li>
<li>snabbdom中子节点的比较方式是：头对头，头对尾， 尾对尾，尾对头</li>
</ul>
</li>
</ul>
</li>
<li>tag和key不相同,则直接删掉重建,不再深度比较</li>
<li>tag和key ,两者都相同,则认为是相同节点,不再比较其它属性,直接继续比较其子节点</li>
</ul>
<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210808193254552.png" alt="image-20210808193254552"></p>
<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210808193038819.png" alt></p>
<p><strong>diff源码解读-snabbdom源码</strong></p>
<ul>
<li><code>patch()</code></li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//patch()函数的大致逻辑,非源码</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">patch</span>(<span class="params">oldVnode: VNode | Element, vnode: VNode</span>): <span class="title">VNode</span> </span>&#123;</span><br><span class="line">    <span class="comment">//第一个参数是否是vnode</span></span><br><span class="line">    <span class="keyword">if</span> (!isVnode(oldVnode)) &#123;</span><br><span class="line">      <span class="comment">//创建一个空的vnode，关联到这个实际的DOM元素,</span></span><br><span class="line">      <span class="comment">//对应patch(container, vnode)的container</span></span><br><span class="line">      oldVnode = emptyNodeAt(oldVnode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//相同的vnode(key和sel都相等)</span></span><br><span class="line">    <span class="keyword">if</span> (sameVnode(oldVnode, vnode)) &#123;</span><br><span class="line">      <span class="comment">//对比两个vnode</span></span><br><span class="line">      patchVnode(oldVnode, vnode, insertedVnodeQueue);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//不同的vnode， 直接删掉重建</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      elm = oldVnode.elm!;</span><br><span class="line">      parent = api.parentNode(elm) <span class="keyword">as</span> Node;</span><br><span class="line">      <span class="comment">//重建</span></span><br><span class="line">      createElm(vnode, insertedVnodeQueue);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>sameVnode()</code></li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断相同vnode的函数sameVnode()</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sameVnode</span>(<span class="params">vnode1: VNode, vnode2: VNode</span>): <span class="title">boolean</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> isSameKey = vnode1.key === vnode2.key; <span class="comment">//都不传key,则都为undefine,结果仍然为true</span></span><br><span class="line">  <span class="keyword">const</span> isSameIs = vnode1.data?.is === vnode2.data?.is;</span><br><span class="line">  <span class="keyword">const</span> isSameSel = vnode1.sel === vnode2.sel;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> isSameSel &amp;&amp; isSameKey &amp;&amp; isSameIs;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>patchVnode()</code><ul>
<li>oldCh和newCh都有Children则调用updateChildren </li>
<li>newCh有Children, oldCh无Children则调用addVnodes</li>
<li>oldCh有Children, newCh无Children则调用removeVnodes</li>
</ul>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//patchVnode()函数的大致逻辑,非源码 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">patchVnode</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    oldVnode: VNode,</span></span></span><br><span class="line"><span class="function"><span class="params">    vnode: VNode,</span></span></span><br><span class="line"><span class="function"><span class="params">    insertedVnodeQueue: VNodeQueue</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置vnode.elm</span></span><br><span class="line">    <span class="keyword">const</span> elm = (vnode.elm = oldVnode.elm)!;</span><br><span class="line">    <span class="comment">//旧的children</span></span><br><span class="line">    <span class="keyword">const</span> oldCh = oldVnode.children <span class="keyword">as</span> VNode[];</span><br><span class="line">    <span class="comment">//新的children</span></span><br><span class="line">    <span class="keyword">const</span> ch = vnode.children <span class="keyword">as</span> VNode[];</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//新的vnode.text === undefined (vnode.children !== undefined)</span></span><br><span class="line">    <span class="keyword">if</span> (isUndef(vnode.text)) &#123;</span><br><span class="line">      <span class="comment">//新旧都有children</span></span><br><span class="line">      <span class="keyword">if</span> (isDef(oldCh) &amp;&amp; isDef(ch)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (oldCh !== ch) updateChildren(elm, oldCh, ch, insertedVnodeQueue);</span><br><span class="line">      <span class="comment">//新children有，旧children无，（旧vnode可能有text）</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(ch)) &#123;</span><br><span class="line">        <span class="comment">//清空text</span></span><br><span class="line">        <span class="keyword">if</span> (isDef(oldVnode.text)) api.setTextContent(elm, <span class="string">""</span>);</span><br><span class="line">        <span class="comment">//添加children</span></span><br><span class="line">        addVnodes(elm, <span class="literal">null</span>, ch, <span class="number">0</span>, ch.length - <span class="number">1</span>, insertedVnodeQueue);</span><br><span class="line">      <span class="comment">//旧children有，新children无</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(oldCh)) &#123;</span><br><span class="line">        <span class="comment">//移除旧children</span></span><br><span class="line">        removeVnodes(elm, oldCh, <span class="number">0</span>, oldCh.length - <span class="number">1</span>);</span><br><span class="line">      <span class="comment">//旧text有值</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDef(oldVnode.text)) &#123;</span><br><span class="line">        <span class="comment">//散出旧text</span></span><br><span class="line">        api.setTextContent(elm, <span class="string">""</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//新的vnode.text !== undefined (vnode.children === undefined)</span></span><br><span class="line">    <span class="comment">//新的vnode.text !== 旧的vnode.text</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (oldVnode.text !== vnode.text) &#123;</span><br><span class="line">      <span class="comment">//移除旧children</span></span><br><span class="line">      <span class="keyword">if</span> (isDef(oldCh)) &#123;</span><br><span class="line">        removeVnodes(elm, oldCh, <span class="number">0</span>, oldCh.length - <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//设置新text</span></span><br><span class="line">      api.setTextContent(elm, vnode.text!);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>updateChildren()</code><ul>
<li>头对头，头对尾， 尾对尾，尾对头的比较</li>
<li>如何以上都没有命中则判断新节点中有没有key和老节点是一样的（v-for用key的原因）<ul>
<li>如果没有则直接添加新节点</li>
<li>如果有则再判断是否sel(节点标签)也一样<ul>
<li>如果不是则直接添加新节点</li>
<li>如果是（key和sel都相同）则调用patchVnode继续比较子节点</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateChildren</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    parentElm: Node,</span></span></span><br><span class="line"><span class="function"><span class="params">    oldCh: VNode[],</span></span></span><br><span class="line"><span class="function"><span class="params">    newCh: VNode[],</span></span></span><br><span class="line"><span class="function"><span class="params">    insertedVnodeQueue: VNodeQueue</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (oldStartIdx &lt;= oldEndIdx &amp;&amp; newStartIdx &lt;= newEndIdx) &#123;</span><br><span class="line">      <span class="keyword">if</span> (oldStartVnode == <span class="literal">null</span>) &#123;</span><br><span class="line">        oldStartVnode = oldCh[++oldStartIdx]; <span class="comment">// Vnode might have been moved left</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (oldEndVnode == <span class="literal">null</span>) &#123;</span><br><span class="line">        oldEndVnode = oldCh[--oldEndIdx];</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (newStartVnode == <span class="literal">null</span>) &#123;</span><br><span class="line">        newStartVnode = newCh[++newStartIdx];</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (newEndVnode == <span class="literal">null</span>) &#123;</span><br><span class="line">        newEndVnode = newCh[--newEndIdx];</span><br><span class="line">      <span class="comment">//开始和开始比对</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldStartVnode, newStartVnode)) &#123;</span><br><span class="line">        patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue);</span><br><span class="line">        oldStartVnode = oldCh[++oldStartIdx];</span><br><span class="line">        newStartVnode = newCh[++newStartIdx];</span><br><span class="line">      <span class="comment">//结束和结束比对</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldEndVnode, newEndVnode)) &#123;</span><br><span class="line">        patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue);</span><br><span class="line">        oldEndVnode = oldCh[--oldEndIdx];</span><br><span class="line">        newEndVnode = newCh[--newEndIdx];</span><br><span class="line">      <span class="comment">//旧children开始和新children结束比对</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldStartVnode, newEndVnode)) &#123;</span><br><span class="line">        <span class="comment">// Vnode moved right</span></span><br><span class="line">        patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue);</span><br><span class="line">        api.insertBefore(</span><br><span class="line">          parentElm,</span><br><span class="line">          oldStartVnode.elm!,</span><br><span class="line">          api.nextSibling(oldEndVnode.elm!)</span><br><span class="line">        );</span><br><span class="line">        oldStartVnode = oldCh[++oldStartIdx];</span><br><span class="line">        newEndVnode = newCh[--newEndIdx];</span><br><span class="line">      <span class="comment">//旧children结束和新children开始比对</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldEndVnode, newStartVnode)) &#123;</span><br><span class="line">        <span class="comment">// Vnode moved left</span></span><br><span class="line">        patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue);</span><br><span class="line">        api.insertBefore(parentElm, oldEndVnode.elm!, oldStartVnode.elm!);</span><br><span class="line">        oldEndVnode = oldCh[--oldEndIdx];</span><br><span class="line">        newStartVnode = newCh[++newStartIdx];</span><br><span class="line">      <span class="comment">//以上比对都未命中</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (oldKeyToIdx === <span class="literal">undefined</span>) &#123;</span><br><span class="line">          oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//拿新节点key,能否对应上oldChildren中某个节点的key</span></span><br><span class="line">        idxInOld = oldKeyToIdx[newStartVnode.key <span class="keyword">as</span> <span class="built_in">string</span>];</span><br><span class="line">        <span class="comment">//没对应导上</span></span><br><span class="line">        <span class="keyword">if</span> (isUndef(idxInOld)) &#123;</span><br><span class="line">          <span class="comment">// New element</span></span><br><span class="line">          api.insertBefore(</span><br><span class="line">            parentElm,</span><br><span class="line">            createElm(newStartVnode, insertedVnodeQueue),</span><br><span class="line">            oldStartVnode.elm!</span><br><span class="line">          );</span><br><span class="line">        <span class="comment">//对应上了</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">//对应上key的节点</span></span><br><span class="line">          elmToMove = oldCh[idxInOld];</span><br><span class="line">          <span class="comment">//sel是否相等（sameVnode()的条件）</span></span><br><span class="line">          <span class="keyword">if</span> (elmToMove.sel !== newStartVnode.sel) &#123;</span><br><span class="line">            <span class="comment">//新建</span></span><br><span class="line">            api.insertBefore(</span><br><span class="line">              parentElm,</span><br><span class="line">              createElm(newStartVnode, insertedVnodeQueue),</span><br><span class="line">              oldStartVnode.elm!</span><br><span class="line">            );</span><br><span class="line">          <span class="comment">//sel相等， key相等</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            patchVnode(elmToMove, newStartVnode, insertedVnodeQueue);</span><br><span class="line">            oldCh[idxInOld] = <span class="literal">undefined</span> <span class="keyword">as</span> <span class="built_in">any</span>;</span><br><span class="line">            api.insertBefore(parentElm, elmToMove.elm!, oldStartVnode.elm!);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        newStartVnode = newCh[++newStartIdx];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>





<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210808202413510.png" alt="image-20210808202413510"></p>
<ul>
<li>diff算法总结<ul>
<li>patchVnode</li>
<li>addVnodes removeVnodes</li>
<li>updateChildren ( key的重要性)</li>
</ul>
</li>
</ul>
<h3 id="模板编译"><a href="#模板编译" class="headerlink" title="模板编译"></a>模板编译</h3><h4 id="with语法"><a href="#with语法" class="headerlink" title="with语法"></a><strong>with语法</strong></h4><ul>
<li>改变{}内自由变量的查找规则,当做obj属性来查找</li>
<li>如果找不到匹配的obj属性,就会报错</li>
<li>with要慎用,它打破了作用域规则,易读性变差</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">a</span>: <span class="number">100</span>, <span class="attr">b</span>: <span class="number">200</span>&#125; </span><br><span class="line"><span class="built_in">console</span>.log(obj.a)</span><br><span class="line"><span class="built_in">console</span>.log(obj.b)</span><br><span class="line"><span class="built_in">console</span>.log(obj.c) <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用with,能改变&#123;&#125;内自由变量的查找方式</span></span><br><span class="line"><span class="comment">//将&#123;&#125;内自由变量，当做obj 的属性来查找</span></span><br><span class="line"><span class="keyword">with</span>(obj) &#123;</span><br><span class="line"><span class="built_in">console</span>.log(a)</span><br><span class="line"><span class="built_in">console</span>.log(b)</span><br><span class="line"><span class="built_in">console</span>.log(c) <span class="comment">//会报错! ! !</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="理解模板编译"><a href="#理解模板编译" class="headerlink" title="理解模板编译"></a><strong>理解模板编译</strong></h4><ul>
<li>模板不是html , 有指令、插值、JS 表达式,能实现判断、循环</li>
<li>htmI是标签语言,只有JS才能实现判断、循环(图灵完备的)</li>
<li>因此，模板一定是转换为某种JS代码,即编译模板（将.vue文件中的模板编译成js代码的过程）</li>
<li>模板编译成的js代码就是render函数,执行render函数返回vnode</li>
<li>基于vnode再执行patch和diff ，实现虚拟dom, 页面渲染</li>
<li>使用webpack vue-loader , 会在开发环境下编译模板(重要，因为在开发环境下完成模板编译，使得生产环境不用再进行模板编辑，减少了计算，提高了性能)</li>
<li>vue组件可以用render代替template</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Vue.component( <span class="string">'heading'</span>, &#123;</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span> (<span class="params">createElement</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createElement (</span><br><span class="line">            <span class="string">'h'</span> + <span class="keyword">this</span>. Level,</span><br><span class="line">            [</span><br><span class="line">                createElement(<span class="string">'a'</span>, &#123;</span><br><span class="line">                    attrs: &#123;</span><br><span class="line">                        name: <span class="string">' headerId'</span> ,</span><br><span class="line">                        href: <span class="string">'#'</span> + <span class="string">'headerId'</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,<span class="string">'this is a tag'</span>)</span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//上面的render函数还原成模板，大概就是下面的写法</span></span><br><span class="line">Vue.component( <span class="string">'heading'</span>, &#123;</span><br><span class="line">    template:<span class="string">`</span></span><br><span class="line"><span class="string">		&lt;h1&gt;</span></span><br><span class="line"><span class="string">			&lt;a name="headerId" href="headerId"/&gt;</span></span><br><span class="line"><span class="string">        &lt;/h1&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="vue中的模板编译"><a href="#vue中的模板编译" class="headerlink" title="vue中的模板编译"></a>vue中的模板编译</h4><blockquote>
<p>使用vue-template-compiler</p>
</blockquote>
<p><strong>搭建测试环境</strong></p>
<ul>
<li>新建测试文件夹</li>
<li>初始化</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure>

<ul>
<li>安装vue-template-compiler</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-template-compiler --save</span><br></pre></td></tr></table></figure>

<ul>
<li><p>新建index.js</p>
</li>
<li><p>运行</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node .\index.js</span><br></pre></td></tr></table></figure>

<p><strong>实现模板编译相关函数理解</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compiler = <span class="built_in">require</span>(<span class="string">'vue-template-compiler'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插值</span></span><br><span class="line"><span class="comment">// const template = `&lt;p&gt;&#123;&#123;message&#125;&#125;&lt;/p&gt;`</span></span><br><span class="line"><span class="comment">// with(this)&#123;return _c('p',[_v(_s(message))])&#125;</span></span><br><span class="line"><span class="comment">// with(this)&#123;return createElement('p',[createTextVNode(toString(message))])&#125;</span></span><br><span class="line"><span class="comment">// h -&gt; vnode</span></span><br><span class="line"><span class="comment">// createElement -&gt; vnode</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// // 表达式</span></span><br><span class="line"><span class="comment">// const template = `&lt;p&gt;&#123;&#123;flag ? message : 'no message found'&#125;&#125;&lt;/p&gt;`</span></span><br><span class="line"><span class="comment">// // with(this)&#123;return _c('p',[_v(_s(flag ? message : 'no message found'))])&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// // 属性和动态属性</span></span><br><span class="line"><span class="comment">// const template = `</span></span><br><span class="line"><span class="comment">//     &lt;div id="div1" class="container"&gt;</span></span><br><span class="line"><span class="comment">//         &lt;img :src="imgUrl"/&gt;</span></span><br><span class="line"><span class="comment">//     &lt;/div&gt;</span></span><br><span class="line"><span class="comment">// `</span></span><br><span class="line"><span class="comment">// with(this)&#123;return _c('div',</span></span><br><span class="line"><span class="comment">//      &#123;staticClass:"container",attrs:&#123;"id":"div1"&#125;&#125;,</span></span><br><span class="line"><span class="comment">//      [</span></span><br><span class="line"><span class="comment">//          _c('img',&#123;attrs:&#123;"src":imgUrl&#125;&#125;)</span></span><br><span class="line"><span class="comment">//      ])&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// // 条件</span></span><br><span class="line"><span class="comment">// const template = `</span></span><br><span class="line"><span class="comment">//     &lt;div&gt;</span></span><br><span class="line"><span class="comment">//         &lt;p v-if="flag === 'a'"&gt;A&lt;/p&gt;</span></span><br><span class="line"><span class="comment">//         &lt;p v-else&gt;B&lt;/p&gt;</span></span><br><span class="line"><span class="comment">//     &lt;/div&gt;</span></span><br><span class="line"><span class="comment">// `</span></span><br><span class="line"><span class="comment">// with(this)&#123;return _c('div',[(flag === 'a')?_c('p',[_v("A")]):_c('p',[_v("B")])])&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 循环</span></span><br><span class="line"><span class="comment">// const template = `</span></span><br><span class="line"><span class="comment">//     &lt;ul&gt;</span></span><br><span class="line"><span class="comment">//         &lt;li v-for="item in list" :key="item.id"&gt;&#123;&#123;item.title&#125;&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">//     &lt;/ul&gt;</span></span><br><span class="line"><span class="comment">// `</span></span><br><span class="line"><span class="comment">// with(this)&#123;return _c('ul',_l((list),function(item)&#123;return _c('li',&#123;key:item.id&#125;,[_v(_s(item.title))])&#125;),0)&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 事件</span></span><br><span class="line"><span class="comment">// const template = `</span></span><br><span class="line"><span class="comment">//     &lt;button @click="clickHandler"&gt;submit&lt;/button&gt;</span></span><br><span class="line"><span class="comment">// `</span></span><br><span class="line"><span class="comment">// with(this)&#123;return _c('button',&#123;on:&#123;"click":clickHandler&#125;&#125;,[_v("submit")])&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// v-model</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`&lt;input type="text" v-model="name"&gt;`</span></span><br><span class="line"><span class="comment">// 主要看 input 事件</span></span><br><span class="line"><span class="comment">// with(this)&#123;return _c('input',&#123;directives:[&#123;name:"model",rawName:"v-model",value:(name),expression:"name"&#125;],attrs:&#123;"type":"text"&#125;,domProps:&#123;"value":(name)&#125;,on:&#123;"input":function($event)&#123;if($event.target.composing)return;name=$event.target.value&#125;&#125;&#125;)&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// render 函数</span></span><br><span class="line"><span class="comment">// 返回 vnode</span></span><br><span class="line"><span class="comment">// patch</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 编译</span></span><br><span class="line"><span class="keyword">const</span> res = compiler.compile(template)</span><br><span class="line"><span class="built_in">console</span>.log(res.render)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------------分割线--------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// // 从 vue 源码中找到缩写函数的含义</span></span><br><span class="line"><span class="comment">// function installRenderHelpers (target) &#123;</span></span><br><span class="line"><span class="comment">//     target._o = markOnce;</span></span><br><span class="line"><span class="comment">//     target._n = toNumber;</span></span><br><span class="line"><span class="comment">//     target._s = toString;</span></span><br><span class="line"><span class="comment">//     target._l = renderList;</span></span><br><span class="line"><span class="comment">//     target._t = renderSlot;</span></span><br><span class="line"><span class="comment">//     target._q = looseEqual;</span></span><br><span class="line"><span class="comment">//     target._i = looseIndexOf;</span></span><br><span class="line"><span class="comment">//     target._m = renderStatic;</span></span><br><span class="line"><span class="comment">//     target._f = resolveFilter;</span></span><br><span class="line"><span class="comment">//     target._k = checkKeyCodes;</span></span><br><span class="line"><span class="comment">//     target._b = bindObjectProps;</span></span><br><span class="line"><span class="comment">//     target._v = createTextVNode;</span></span><br><span class="line"><span class="comment">//     target._e = createEmptyVNode;</span></span><br><span class="line"><span class="comment">//     target._u = resolveScopedSlots;</span></span><br><span class="line"><span class="comment">//     target._g = bindObjectListeners;</span></span><br><span class="line"><span class="comment">//     target._d = bindDynamicKeys;</span></span><br><span class="line"><span class="comment">//     target._p = prependModifier;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="渲染过程"><a href="#渲染过程" class="headerlink" title="渲染过程"></a>渲染过程</h3><h3 id="前端路由"><a href="#前端路由" class="headerlink" title="前端路由"></a>前端路由</h3><blockquote>
<ul>
<li>hash模式(默认) ,如<code>http://abc.com/#/user/10</code></li>
<li>H5 history模式,如<code>http://abc.com/user/20</code></li>
</ul>
</blockquote>
<h4 id="hash模式"><a href="#hash模式" class="headerlink" title="hash模式"></a><strong>hash模式</strong></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// http://127.0.0.1:8881/01-hash.html?a=100&amp;b=20#/aaa/bbb</span></span><br><span class="line">location.protocol <span class="comment">// 'http: '</span></span><br><span class="line">location.hostname <span class="comment">// '127.0.0.1'</span></span><br><span class="line">location.host<span class="comment">// '127.0.0.1:8881'</span></span><br><span class="line">location.port <span class="comment">// '8881'</span></span><br><span class="line">location.pathname <span class="comment">// '/01-hash.html'</span></span><br><span class="line">location.search <span class="comment">// ' ?a=100&amp;b=20'</span></span><br><span class="line">location.hash <span class="comment">// '#/aaa/bbb'</span></span><br></pre></td></tr></table></figure>

<ul>
<li>hash模式特点<ul>
<li>hash变化会触发网页跳转，即浏览器的前进、后退</li>
<li>hash 变化不会刷新页面，SPA（单页面应用）必需的特点</li>
<li>hash永远不会提交到server端（前端自生自灭）</li>
</ul>
</li>
<li>hash核心API<ul>
<li>window.onhashchange</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hash test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>hash test<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn1"</span>&gt;</span>修改 hash<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// hash 变化，包括：</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// a. JS 修改 url</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// b. 手动修改 url 的 hash  z</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// c. 浏览器前进、后退</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.onhashchange = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'old url'</span>, event.oldURL)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'new url'</span>, event.newURL)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'hash:'</span>, location.hash)</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// 页面初次加载，获取 hash</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.addEventListener(<span class="string">'DOMContentLoaded'</span>, () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'hash:'</span>, location.hash)</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// JS 修改 url</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">'btn1'</span>).addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span></span><br><span class="line"><span class="actionscript">            location.href = <span class="string">'#/user'</span></span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="H5-history"><a href="#H5-history" class="headerlink" title="H5 history"></a><strong>H5 history</strong></h4><ul>
<li>H5 history 模式特点<ul>
<li>用url规范的路由，但跳转时不刷新页面</li>
<li>需要server端支持，因此无特殊需求可选择hash模式<ul>
<li>前端路由有很多个（多个url），所以需要后端在接受任何url的时候都返回主文件</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">例如前端初始url: https:<span class="comment">//localhost/index</span></span><br><span class="line">后端没有做配置的情况下：</span><br><span class="line">浏览器输入 https:<span class="comment">//localhost/index, 后端会返回主文件（单页面应用的文件）</span></span><br><span class="line">前端跳转了路由url变为: https:<span class="comment">//localhost/user , 此时刷新页面就会报错找不到该页面，因为后端只能默认响应 https://localhost/index的请求返回主文件，不能对路由变化的url做出响应</span></span><br><span class="line"></span><br><span class="line">后端配置，设置任何路由形式的访问都返回主文件</span><br><span class="line">此时前端路由变化后，再次刷新页面就可以正常请求到主文件了</span><br></pre></td></tr></table></figure>

<ul>
<li>H5 history 的核心API<ul>
<li>history.pushState  （新增时即做页面渲染，因为新增不触发window.onpopstate）</li>
<li>window.onpopstate(只有浏览器前进后退时才触发，history.pushState新增路由时不会触发)</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>history API test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>history API test<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn1"</span>&gt;</span>修改 url<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 页面初次加载，获取 path</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.addEventListener(<span class="string">'DOMContentLoaded'</span>, () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'load'</span>, location.pathname)</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// 打开一个新的路由</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 【注意】用 pushState 方式，浏览器不会刷新页面</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">'btn1'</span>).addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">const</span> state = &#123; name: <span class="string">'page1'</span> &#125;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'切换路由到'</span>, <span class="string">'page1'</span>)  <span class="comment">// 此处做页面渲染</span></span></span><br><span class="line"><span class="actionscript">            history.pushState(state, <span class="string">''</span>, <span class="string">'page1'</span>) <span class="comment">// 重要！！</span></span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// 监听浏览器前进、后退</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.onpopstate = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123; <span class="comment">// 重要！！</span></span></span><br><span class="line"><span class="actionscript">            <span class="comment">//这里的event.state就是上面history.pushState(state, '', 'page1')的state</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'onpopstate'</span>, event.state, location.pathname) <span class="comment">// 此处做页面渲染</span></span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// 需要 server 端配合，可参考</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E4%BE%8B%E5%AD%90</span></span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>hash和H5 history选择</strong></p>
<ul>
<li>to B的系统推荐用hash ，简单易用，对url规范不敏感</li>
<li>to C的系统，可以考虑选择H5 history ，但需要服务端支持</li>
</ul>
<h2 id="面试题汇总"><a href="#面试题汇总" class="headerlink" title="面试题汇总"></a>面试题汇总</h2><p>1 v-show和v-if 的区别</p>
<ul>
<li>v-if条件为false时，对应的元素以及其子元素不会渲染。(通过Vue控制)  回流</li>
<li>v-show条件为false时，对应的元素以及其子元素会渲染。只是将元素的display属性设置为none，所以没有显示出来。（通过css控制）重绘</li>
<li>总结：<ul>
<li>当需要在显示与隐藏之间切片很频繁时，使用v-show</li>
<li>当只有少次切换时，通常使用v-if</li>
</ul>
</li>
</ul>
<p>2 为何v-for 中要用key</p>
<ul>
<li>必须用key ，且不能是index和random</li>
<li>diff 算法中通过tag和key来判断，是否是sameNode（结合比对方式）</li>
<li>减少渲染次数，提升渲染性能</li>
</ul>
<p>3 描述Vue 组件生命周期（有父子组件的情况)</p>
<blockquote>
<p><a href="https://chuckiewill.github.io/2020/06/10/Vue/Vuejs/" target="_blank" rel="noopener">Chuckie’s Blog - Vue</a></p>
</blockquote>
<p>4 vue 组件如何通讯</p>
<blockquote>
<p><a href="https://chuckiewill.github.io/2020/06/10/Vue/Vuejs/" target="_blank" rel="noopener">Chuckie’s Blog - Vue</a></p>
</blockquote>
<ul>
<li>父子组件props和this.$emit</li>
<li>自定义事件event.$no event.$off event.$emit</li>
<li>vuex</li>
</ul>
<p>5 描述组件渲染和更新的过程（一个组件渲染到页面,修改data触发更新(数据驱动视图)）</p>
<blockquote>
<ul>
<li>响应式:监听data属性getter setter (包括数组)</li>
<li>模板编译:模板到render函数,再到vnode</li>
<li>vdom : patch(elem, vnode)和patch(vnode, newVnode)</li>
</ul>
</blockquote>
<ul>
<li>初始渲染过程<ul>
<li>解析模板为render函数(或在开发环境完成，通过webpack的vue-loader )</li>
<li>触发响应式,监听data属性getter setter</li>
<li>执行render函数,生成vnode， patch(elem, vnode),  <em>在这个过程中会触发getter</em></li>
</ul>
</li>
<li>更新过程.<ul>
<li>修改data，触发setter ( 此前在getter中已被监听)</li>
<li>重新执行render函数,生成newVnode</li>
<li>patch(vnode, newVnode)<br><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210809104851066.png" alt="image-20210809104851066"></li>
</ul>
</li>
<li>异步渲染<ul>
<li>回顾$nextTick</li>
<li>汇总data的修改，一次性更新视图</li>
<li>减少DOM操作次数,提高性能</li>
</ul>
</li>
</ul>
<p>6 双向数据绑定v-model的实现原理</p>
<ul>
<li>input元素的value = this.name(name是双向绑定的变量)</li>
<li>绑定input事件this.name = $event.target.value</li>
<li>data 更新触发re-render</li>
</ul>
<p>7 对MVVM的理解</p>
<blockquote>
<p><a href="https://chuckiewill.github.io/2020/06/10/Vue/Vuejs/" target="_blank" rel="noopener">Chuckie’s Blog - Vue</a></p>
</blockquote>
<p>8 computed 有何特点</p>
<ul>
<li>computed 的计算结果会缓存，data不变不会重新计算</li>
<li>提高性能</li>
</ul>
<p>9 为何组件data必须是一个函数?</p>
<ul>
<li>每个组件就是一个class是一个类，每次使用组件就是对它的实例化，实例化就会执行data()函数，就会为每个使用组件的地方产生一个自己独立的存储空间，每个实例化的组件在修改data属性时不会相互影响</li>
<li>如果data不是一个函数，而是一个对象，则每个实例化的组件data都会指向同一个存储地址，当一个组件修改data属性时，其它组件的data就也修改了，会使组件之间相互影响</li>
</ul>
<p>10 ajax请求应该放在哪个生命周期</p>
<ul>
<li>mounted</li>
<li>JS是单线程的，ajax异步获取数据</li>
<li>放在mounted之前没有用，只会让逻辑更加混乱，</li>
<li>若放在mounted之前，由于js是单线程，且ajax是异步请求，所以还是会先进行页面渲染，再网络请求，而mounted恰恰就是在页面渲染后触发</li>
</ul>
<p>11 如何将组件所有props传递给子组件?</p>
<ul>
<li>$props</li>
<li><code>&lt;User v-bind= &quot;$props”/&gt;</code></li>
<li>细节知识点，优先级不高</li>
</ul>
<p>12 自定义v-model</p>
<p>13 多个组件有相同的逻辑，如何抽离?</p>
<ul>
<li>mixin</li>
<li>以及 mixin的一些缺点</li>
</ul>
<p>14 何时要使用异步组件?</p>
<ul>
<li>加载大组件</li>
<li>路由异步加载</li>
</ul>
<p>15 何时需要使用keep-alive ?</p>
<ul>
<li>缓存组件，不需要重复渲染</li>
<li>如多个静态tab 页的切换</li>
</ul>
<p>16 何时需要使用beforeDestory</p>
<ul>
<li>解绑自定义事件event.$off</li>
<li>清除定时器</li>
<li>解绑自定义的DOM 事件，如window scroll 等</li>
</ul>
<p>17 什么是作用域插槽</p>
<p>18 Vuex中action和mutation有何区别</p>
<ul>
<li>action中处理异步，mutation 不可以</li>
<li>mutation做原子操作</li>
<li>action可以整合多个mutation</li>
</ul>
<p>19 Vue-router常用的路由模式</p>
<ul>
<li>hash 默认</li>
<li>H5 history(需要服务端支持)</li>
<li>两者比较</li>
</ul>
<p>20 如何配置Vue-router 异步加载</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> VueRouter(i</span><br><span class="line">    routes: [</span><br><span class="line">        &#123;</span><br><span class="line">            path: <span class="string">'/'</span>,</span><br><span class="line">            component: <span class="function"><span class="params">()</span>=&gt;</span> <span class="keyword">import</span>(</span><br><span class="line">            	 <span class="comment">//webpackChunkName:T"navigator"</span></span><br><span class="line">           		 <span class="string">'./ ../ components/Navigator'</span></span><br><span class="line">            )</span><br><span class="line">        &#125;,&#123;</span><br><span class="line">            path: <span class="string">' /feedback '</span> ,</span><br><span class="line">            component:<span class="function"><span class="params">()</span>=&gt;</span> <span class="keyword">import</span>(</span><br><span class="line">           		 <span class="comment">/* webpackChunkName: "feedback"*/</span></span><br><span class="line">              	<span class="string">'./../ components/FeedBack'</span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>21 请用vnode描述一个 DOM结构</p>
<p>22 监听data变化的核心API是什么</p>
<ul>
<li>Object.defineProperty</li>
<li>以及深度监听、监听数组</li>
<li>有何缺点</li>
</ul>
<p>23 Vue如何监听数组变化</p>
<ul>
<li>Object.defineProperty不能监听数组变化</li>
<li>重新定义原型，重写push pop等方法，实现监听</li>
<li>Proxy可以原生支持监听数组变化</li>
</ul>
<p>24 请描述响应式原理</p>
<ul>
<li>监听data变化</li>
<li>组件渲染和更新的流程</li>
</ul>
<p>25 diff 算法的时间复杂度</p>
<ul>
<li>o(n)</li>
<li>在O(n^3)基础上做了一些调整（3个调整）</li>
</ul>
<p>26 简述diff 算法过程</p>
<ul>
<li>patch(elem, vnode)和patch(vnode, newVnode)</li>
<li>patchVnode和addVnodes和removeVnodes</li>
<li>updateChildren ( key的重要性)</li>
</ul>
<p>27 Vue为何是异步渲染，$nextTick何用?</p>
<ul>
<li>异步渲染（以及合并data修改），以提高渲染性能</li>
<li>$nextTick在 DOM更新完之后，触发回调, 但此时图片或视频的加载可能还没有完成</li>
</ul>
<p>28 Vue常见性能优化方式</p>
<ul>
<li><p>渲染</p>
<ul>
<li><p>合理使用v-show、v-if、keep-alive</p>
</li>
<li><p>合理使用异步组件</p>
</li>
<li><p>v-for 时加key ，以及避免和v-if 同时使用</p>
</li>
</ul>
</li>
<li><p>响应式</p>
<ul>
<li>data层级不要太深（响应式原理结合）</li>
</ul>
</li>
<li><p>缓存</p>
<ul>
<li>合理使用computed</li>
</ul>
</li>
<li><p>资源利用</p>
<ul>
<li><p>自定义事件、DOM事件及时销毁</p>
</li>
<li><p>使用vue-loader在开发环境做模板编译（预编译)</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>前端通用的性能优化</p>
<ul>
<li>图片懒加载</li>
<li>代码压缩</li>
<li>CSS放在head ,JS放在body最下面</li>
<li>尽早开始执行JS，用DOMContentLoaded触发</li>
<li>对DOM查询进行缓存</li>
<li>频繁DOM操作，合并到一起插入DOM结构</li>
<li>防抖</li>
<li>节流</li>
</ul>
</li>
<li><p>webpack层面的优化(后面会讲)</p>
</li>
<li><p>使用SSR</p>
</li>
</ul>
<h1 id="二、Vue3"><a href="#二、Vue3" class="headerlink" title="二、Vue3"></a>二、Vue3</h1><blockquote>
<p>Vue3体积更小</p>
<p>CompositionAPI<em>更好的类型推导？？？？？？</em></p>
</blockquote>
<h2 id="Vue3优势"><a href="#Vue3优势" class="headerlink" title="Vue3优势"></a>Vue3优势</h2><p>1 Vue3比 Vue2有什么优势?</p>
<ul>
<li>性能更好</li>
<li><em>体积更小？？？？？</em></li>
<li>更好的代码组织</li>
<li>更好的逻辑抽离</li>
<li>更好的ts支持</li>
<li>更多新功能</li>
</ul>
<h2 id="Vue3生命周期"><a href="#Vue3生命周期" class="headerlink" title="Vue3生命周期"></a>Vue3生命周期</h2><p>2 描述Vue3生命周期</p>
<ul>
<li>Options API生命周期<ul>
<li>beforeDestroy改为beforeUnmount（只改名）</li>
<li>destroyed改为unmouted（只改名）</li>
<li>其他沿用Vue2的生命周期</li>
</ul>
</li>
<li>Composition API<ul>
<li>需要引入</li>
<li>setup()代替beforeCreate()和created()</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// setup 等于 beforeCreate 和 created</span></span><br><span class="line">    setup() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'setup'</span>)</span><br><span class="line"></span><br><span class="line">        onBeforeMount(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'onBeforeMount'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        onMounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'onMounted'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        onBeforeUpdate(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'onBeforeUpdate'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        onUpdated(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'onUpdated'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        onBeforeUnmount(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'onBeforeUnmount'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        onUnmounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'onUnmounted'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Composition-API和Options-API"><a href="#Composition-API和Options-API" class="headerlink" title="Composition API和Options API"></a>Composition API和Options API</h2><p>3 如何看待Composition API和Options API ?</p>
<ul>
<li>Composition API (为大型项目而设计)<ul>
<li>更好的代码组织</li>
<li>更好的逻辑复用(有一道专门的面试题)</li>
<li><em>更好的类型推导？？？？？？</em></li>
</ul>
</li>
<li>如何选择?<ul>
<li>不建议共用，会引起混乱</li>
<li>小型项目、业务逻辑简单，用Options API</li>
<li>中大型项目、逻辑复杂，用Composition API</li>
</ul>
</li>
<li>别误解Composition API<ul>
<li>Composition API属于高阶技巧，不是基础必会</li>
<li>Composition API是为解决复杂业务逻辑而设计</li>
<li>Composition API就像Hooks在 React中的地位</li>
</ul>
</li>
</ul>
<h2 id="ref、toRef、toRefs"><a href="#ref、toRef、toRefs" class="headerlink" title="ref、toRef、toRefs"></a>ref、toRef、toRefs</h2><p>4 如何理解ref toRef和toRefs ?</p>
<h4 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h4><ul>
<li>生成值类型的响应式数据</li>
<li>可用于模板和reactive</li>
<li>通过<code>.value</code>修改值和获取值, 模板、reactive中获取不需要通过<code>.value</code></li>
<li>通过ref可以获取到标签</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;!-- 模板中获取不用.value --&gt;</span><br><span class="line">    &lt;p&gt;ref demo &#123;&#123;ageRef&#125;&#125; &#123;&#123;state.name&#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, reactive &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name: <span class="string">'Ref'</span>,</span><br><span class="line">    setup() &#123;</span><br><span class="line">        <span class="keyword">const</span> ageRef = ref(<span class="number">20</span>) <span class="comment">// 值类型 响应式</span></span><br><span class="line">        <span class="keyword">const</span> nameRef = ref(<span class="string">'Chuckie'</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> state = reactive(&#123;</span><br><span class="line">            name: nameRef  <span class="comment">//reactive中获取不用.value</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'ageRef'</span>, ageRef.value)<span class="comment">// 获取也用.value</span></span><br><span class="line"></span><br><span class="line">            ageRef.value = <span class="number">25</span> <span class="comment">// .value 修改值</span></span><br><span class="line">            nameRef.value = <span class="string">'ChuckieA'</span></span><br><span class="line">        &#125;, <span class="number">1500</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            ageRef,</span><br><span class="line">            state</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过ref可以获取到标签</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;p ref=<span class="string">"elemRef"</span>&gt;我是一行文字&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, onMounted &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name: <span class="string">'RefTemplate'</span>,</span><br><span class="line">    setup() &#123;</span><br><span class="line">        <span class="keyword">const</span> elemRef = ref(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line">        onMounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'ref template'</span>, elemRef.value.innerHTML, elemRef.value)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            elemRef</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="toRef"><a href="#toRef" class="headerlink" title="toRef"></a>toRef</h4><ul>
<li>一个普通对象要实现响应式用reactive</li>
<li>reactive中对象的一个单独属性要单拎出来具有响应式用toRef</li>
<li>toRef产出的值和reactive中原本的那个值指向同一个地址，修改会联动</li>
<li>toRef 如果用于普通对象（非响应式对象），产出的结果不具备响应式</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;p&gt;toRef demo - &#123;&#123;ageRef&#125;&#125; - &#123;&#123;state.name&#125;&#125; &#123;&#123;state.age&#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, toRef, reactive &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name: <span class="string">'ToRef'</span>,</span><br><span class="line">    setup() &#123;</span><br><span class="line">        <span class="keyword">const</span> state = reactive(&#123;</span><br><span class="line">            age: <span class="number">20</span>,</span><br><span class="line">            name: <span class="string">'Chuckie'</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> age1 = computed(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> state.age + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// // toRef 如果用于普通对象（非响应式对象），产出的结果不具备响应式</span></span><br><span class="line">        <span class="comment">// const state = &#123;</span></span><br><span class="line">        <span class="comment">//     age: 20,</span></span><br><span class="line">        <span class="comment">//     name: 'Chuckie'</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> ageRef = toRef(state, <span class="string">'age'</span>)</span><br><span class="line"></span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            state.age = <span class="number">25</span>  <span class="comment">//state.age和ageRef，因为它们指向同一个地址</span></span><br><span class="line">        &#125;, <span class="number">1500</span>)</span><br><span class="line"></span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            ageRef.value = <span class="number">30</span> <span class="comment">//state.age和ageRef，因为它们指向同一个地址</span></span><br><span class="line">        &#125;, <span class="number">3000</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            state,</span><br><span class="line">            ageRef</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="toRefs"><a href="#toRefs" class="headerlink" title="toRefs"></a>toRefs</h4><ul>
<li>将响应式对象( reactive封装）转换为普通对象(但对象中的值还具有响应式)</li>
<li>对象的每个属性，都是 ref 对象</li>
<li>两者（响应式对象和转换成的普通对象）保持引用关系, 即修改是联动了（修改响应式对象属性（state），普通对象属性也会修改）</li>
<li>用toRefs(state)的目的是：在模板中使用state中的属性时不用再通过state.属性的方式获取，直接通过属性名就可以获取</li>
<li>toRefs如果用于普通对象（非响应式对象），产出的结果不具备响应式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;!-- 用toRefs后，就不用通过state.age, state.name这个繁琐的方式再获取了 --&gt;</span><br><span class="line">    &lt;p&gt;toRefs demo &#123;&#123;age&#125;&#125; &#123;&#123;name&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, toRef, toRefs, reactive &#125; from &#39;vue&#39;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#39;ToRefs&#39;,</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const state &#x3D; reactive(&#123;</span><br><span class="line">            age: 20,</span><br><span class="line">            name: &#39;Chuckie&#39;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        const stateAsRefs &#x3D; toRefs(state) &#x2F;&#x2F; 将响应式对象，变成普通对象,但对象中的值还具有响应式</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; const &#123; age: ageRef, name: nameRef &#125; &#x3D; stateAsRefs &#x2F;&#x2F; 每个属性，都是 ref 对象</span><br><span class="line">        &#x2F;&#x2F; return &#123;</span><br><span class="line">        &#x2F;&#x2F;     ageRef,</span><br><span class="line">        &#x2F;&#x2F;     nameRef</span><br><span class="line">        &#x2F;&#x2F; &#125;</span><br><span class="line"></span><br><span class="line">        return stateAsRefs  &#x2F;&#x2F;具有响应式</span><br><span class="line"></span><br><span class="line">        return &#123;</span><br><span class="line">          ...state&#x2F;&#x2F;直接解构state后返回就不具备响应式了</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="最佳使用方式"><a href="#最佳使用方式" class="headerlink" title="最佳使用方式"></a>最佳使用方式</h4><ul>
<li>reactive做对象的响应式，用ref做值类型响应式</li>
<li>setup中返回toRefs(state)，或者toRef(state,‘’xxx’)</li>
<li>ref的变量命名都用xxxRef</li>
<li>合成函数返回响应式对象时，使用toRefs，便于使用方解构</li>
</ul>
<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210809160820646.png" alt="image-20210809160820646"></p>
<h4 id="进阶，深入理解"><a href="#进阶，深入理解" class="headerlink" title="进阶，深入理解"></a>进阶，深入理解</h4><ul>
<li>为何需要ref ?<ul>
<li>Vue3是用Proxy实现响应式，该方式只能对对象实现响应式，不能对值类型实现响应式，而ref使得值类型具有响应式</li>
<li>setup中返回值类型，会丢失响应式，而ref使得值类型具有响应式</li>
<li>如在setup、computed、合成函数，都有可能返回值类型</li>
<li>Vue 如不定义ref ，用户将自造ref ，反而混乱</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// computed 返回的是一个类似于 ref 的对象，也有 .value  age1就是一个类似ref的对象</span></span><br><span class="line">        <span class="keyword">const</span> age1 = computed(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> state.age + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>为何需要.value ?<ul>
<li>ref是一个对象（不丢失响应式) ，value存储值类型的值</li>
<li>通过.value属性的get和set 实现响应式，将值类型转化为一个ref对象，ref对象的.value存储值类型的值，这时ref对象是一个对象就可以用Proxy实现对其属性的监听，就可以实现响应式了</li>
<li>用于模板、reactive时，不需要.value，其他情况都需要</li>
</ul>
</li>
<li>为何需要toRef toRefs ?<ul>
<li>初衷: 在不丢失响应式的情况下，对响应式对象的数据<strong>实现解构</strong></li>
<li>前提︰针对的是响应式对象( reactive封装的)非普通对象</li>
<li>注意:不创造响应式，而是延续响应式</li>
</ul>
</li>
</ul>
<h2 id="Vue3升级"><a href="#Vue3升级" class="headerlink" title="Vue3升级"></a>Vue3升级</h2><blockquote>
<p><a href="https://v3.cn.vuejs.org/guide/migration/introduction.html" target="_blank" rel="noopener">v3迁移指南</a></p>
</blockquote>
<p>5 Vue3升级了哪些重要的功能?</p>
<h4 id="createApp"><a href="#createApp" class="headerlink" title="createApp"></a>createApp</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue2.x</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;<span class="comment">/*选项*/</span> &#125;)</span><br><span class="line">Vue.use(<span class="comment">/* ...*/</span>)</span><br><span class="line">Vue.mixin(<span class="comment">/* ..。*/</span>)</span><br><span class="line">Vue.component(<span class="comment">/* ...*/</span>)</span><br><span class="line">Vue.directive(<span class="comment">/* ...*/</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// vue3</span></span><br><span class="line"><span class="keyword">const</span> app = Vue.createApp(&#123;<span class="comment">/*选项*/</span> &#125;)</span><br><span class="line">app.use(<span class="comment">/* ... */</span>)</span><br><span class="line">app.mixin(<span class="comment">/* ...*/</span>)</span><br><span class="line">app.component(<span class="comment">/* ...*/</span>)</span><br><span class="line">app.directive(<span class="comment">/* ...*/</span>)</span><br></pre></td></tr></table></figure>

<h4 id="emits属性"><a href="#emits属性" class="headerlink" title="emits属性"></a>emits属性</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;HelloWorld msg=<span class="string">"Hello Vue 3.0 + Vite"</span> @onSayHello=<span class="string">"sayHello"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">import HelloWorld from './</span>components/HelloWorld.vue<span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">  name: '</span>App<span class="string">',</span></span><br><span class="line"><span class="string">  components: &#123;</span></span><br><span class="line"><span class="string">    HelloWorld,</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  methods: &#123;</span></span><br><span class="line"><span class="string">    sayHello(info) &#123;</span></span><br><span class="line"><span class="string">      console.log('</span>hello<span class="string">', info)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//子组件</span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">  emits: ['</span>onSayHello<span class="string">'],</span></span><br><span class="line"><span class="string">  setup(props, &#123; emit &#125;) &#123;</span></span><br><span class="line"><span class="string">    emit('</span>onSayHello<span class="string">', '</span>vue3<span class="string">')//vue3是参数</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>



<h4 id="多事件"><a href="#多事件" class="headerlink" title="多事件"></a>多事件</h4><ul>
<li>一个事件可以同时触发多个函数</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在methods 里定义 one two两个函数--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"one($event), two($event)"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h4><ul>
<li>vue2中<code>&lt;template&gt;</code>下必须有一个根标签包裹所有元素</li>
<li>vue3中则不需要，可以直接在<code>&lt;template&gt;</code>下写标签</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- vue2.x组件模板--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"blog-post"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;title &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- vue3 组件模板--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="v-model代替-sync"><a href="#v-model代替-sync" class="headerlink" title="v-model代替.sync"></a>v-model代替.sync</h4><blockquote>
<p><a href="https://v3.cn.vuejs.org/guide/migration/v-model.html#v-model" target="_blank" rel="noopener">v3迁移指南-移除.sync</a></p>
<p>功能：使父组件传入子组件的属性随子组件的变化而实时变化</p>
<p>本质：一个语法糖，仍然是父子间通信的方式实现的</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- vue <span class="number">2.</span>x--&gt;</span><br><span class="line">&lt;MyComponent v-bind:title.sync=<span class="string">"title"</span>/&gt;</span><br><span class="line">&lt;!-- vue <span class="number">3.</span>x--&gt;</span><br><span class="line">&lt;MyComponent v-model:title=<span class="string">"title"</span> /&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--pageTitle是父组件的属性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">v-model:title</span>=<span class="string">"pageTitle"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ChildComponent.vue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    title: <span class="built_in">String</span> </span><br><span class="line">  &#125;,</span><br><span class="line">  emits: [<span class="string">'update:title'</span>],<span class="comment">//这是规定的写法</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">    changePageTitle(title) &#123;</span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">'update:title'</span>, title) </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="异步组件"><a href="#异步组件" class="headerlink" title="异步组件"></a>异步组件</h4><blockquote>
<p><a href="https://v3.cn.vuejs.org/guide/migration/async-components.html" target="_blank" rel="noopener">v3迁移指南-异步组件</a></p>
<p>需要使用<code>defineAsyncComponent</code>函数，<code>import { defineAsyncComponent } from &#39;vue&#39;</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> asyncModal = defineAsyncComponent(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./Modal.vue'</span>))</span><br></pre></td></tr></table></figure>

<h4 id="移除filter"><a href="#移除filter" class="headerlink" title="移除filter"></a>移除filter</h4><blockquote>
<p><a href="https://v3.cn.vuejs.org/guide/migration/filters.html#%E8%BF%87%E6%BB%A4%E5%99%A8" target="_blank" rel="noopener">v3迁移指南-移除过滤器</a></p>
</blockquote>
<h4 id="Teleport"><a href="#Teleport" class="headerlink" title="Teleport"></a>Teleport</h4><blockquote>
<p><a href="https://v3.cn.vuejs.org/guide/teleport.html#teleport" target="_blank" rel="noopener">v3迁移指南-Teleport</a></p>
<p>将弹出层直接挂载到body上</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">app.component(<span class="string">'modal-button'</span>, &#123;</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;button @click="modalOpen = true"&gt;</span></span><br><span class="line"><span class="string">        Open full screen modal! (With teleport!)</span></span><br><span class="line"><span class="string">    &lt;/button&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;teleport to="body"&gt; //也可以传送到其它标签下，例如#hello，即传送到id为hello的标签下</span></span><br><span class="line"><span class="string">      &lt;div v-if="modalOpen" class="modal"&gt;</span></span><br><span class="line"><span class="string">        &lt;div&gt;</span></span><br><span class="line"><span class="string">          I'm a teleported modal! </span></span><br><span class="line"><span class="string">          (My parent is "body")</span></span><br><span class="line"><span class="string">          &lt;button @click="modalOpen = false"&gt;</span></span><br><span class="line"><span class="string">            Close</span></span><br><span class="line"><span class="string">          &lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/teleport&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; </span><br><span class="line">      modalOpen: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="Suspense"><a href="#Suspense" class="headerlink" title="Suspense"></a>Suspense</h4><blockquote>
<p><a href="https://v3.cn.vuejs.org/guide/migration/suspense.html#suspense" target="_blank" rel="noopener">v3迁移指南-Suspense</a></p>
<p>使用场景：配合异步组件使用，当异步组件没有加载完成时则显示loading状态</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;suspense&gt;</span><br><span class="line">    &lt;template #default&gt;</span><br><span class="line">      &lt;todo-list &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line">    &lt;template #fallback&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        Loading...</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line">  &lt;&#x2F;suspense&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    TodoList: defineAsyncComponent(() &#x3D;&gt; import(&#39;.&#x2F;TodoList.vue&#39;))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Composition-API"><a href="#Composition-API" class="headerlink" title="Composition API"></a>Composition API</h4><ul>
<li>reactive  实现响应式</li>
<li>watch和watchEffect</li>
<li>ref相关    </li>
<li>setup  等于vue2中的beforeCreate和created</li>
<li>readonly   只读</li>
<li>生命周期钩子函数</li>
</ul>
<h2 id="Composition-API逻辑复用"><a href="#Composition-API逻辑复用" class="headerlink" title="Composition API逻辑复用"></a>Composition API逻辑复用</h2><p>6 Composition API 如何实现代码逻辑复用?</p>
<ul>
<li>抽离逻辑代码到一个函数，这个函数可以在多个组件中使用，这就是逻辑复用</li>
<li>函数命名约定为useXxxx格式( React Hooks也是)</li>
<li>在setup 中引用useXxx函数，逻辑复用的函数就是合成函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;p&gt;mouse position &#123;&#123;x&#125;&#125; &#123;&#123;y&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive &#125; from &#39;vue&#39;</span><br><span class="line">import useMousePosition from &#39;.&#x2F;useMousePosition&#39;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#39;MousePosition&#39;,</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const &#123; x, y &#125; &#x3D; useMousePosition()</span><br><span class="line">        return &#123;</span><br><span class="line">            x,</span><br><span class="line">            y</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//useMousePosition.js</span></span><br><span class="line"><span class="comment">//监听鼠标位置变化，并实时显示到页面</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref, onMounted, onUnmounted &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useMousePosition</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> x = ref(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">const</span> y = ref(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        x.value = e.pageX</span><br><span class="line">        y.value = e.pageY</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    onMounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'useMousePosition mounted'</span>)</span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'mousemove'</span>, update)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    onUnmounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'useMousePosition unMounted'</span>)</span><br><span class="line">        <span class="built_in">window</span>.removeEventListener(<span class="string">'mousemove'</span>, update)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        x,</span><br><span class="line">        y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useMousePosition</span><br></pre></td></tr></table></figure>

<h2 id="Vue3响应式"><a href="#Vue3响应式" class="headerlink" title="Vue3响应式"></a>Vue3响应式</h2><p>7 Vue3如何实现响应式?</p>
<h4 id="Proxy基本使用"><a href="#Proxy基本使用" class="headerlink" title="Proxy基本使用"></a>Proxy基本使用</h4><blockquote>
<p>Proxy 与 Reflect 是 ES6 为了操作对象引入的 API</p>
<p><a href="https://www.runoob.com/w3cnote/es6-reflect-proxy.html" target="_blank" rel="noopener">Proxy 与 Reflect用法</a></p>
</blockquote>
<ul>
<li>Proxy结合Reflect的使用</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// const data = &#123;</span></span><br><span class="line"><span class="comment">//     name: 'zhangsan',</span></span><br><span class="line"><span class="comment">//     age: 20,</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">const</span> data = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxyData = <span class="keyword">new</span> <span class="built_in">Proxy</span>(data, &#123;</span><br><span class="line">    <span class="comment">// target: 传入的data, key: 键, receiver: proxyData</span></span><br><span class="line">    <span class="keyword">get</span>(target, key, receiver) &#123;</span><br><span class="line">        <span class="comment">// 只处理本身（非原型的）属性，主要针对数组（数组ownKeys获取索引和length, 对象ownKeys获取键值）</span></span><br><span class="line">        <span class="keyword">const</span> ownKeys = <span class="built_in">Reflect</span>.ownKeys(target)</span><br><span class="line">        <span class="keyword">if</span> (ownKeys.includes(key)) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'get'</span>, key) <span class="comment">// 监听</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// console.log('get', key) // 监听</span></span><br><span class="line">        <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.get(target, key, receiver)<span class="comment">//返回获取的键值</span></span><br><span class="line">        <span class="keyword">return</span> result <span class="comment">// 返回结果</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>(target, key, val, receiver) &#123;</span><br><span class="line">        <span class="comment">//重复的数据，不处理, 数组操作时设置length其实是多余的，因为添加元素后，length自然就更新了</span></span><br><span class="line">        <span class="keyword">if</span> (val === target[key]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.set(target, key, val, receiver)<span class="comment">//设置成则返回true，否则false</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'set'</span>, key, val)</span><br><span class="line">        <span class="comment">// console.log('result', result) // true</span></span><br><span class="line">        <span class="keyword">return</span> result <span class="comment">// 是否设置成功</span></span><br><span class="line">    &#125;,</span><br><span class="line">    deleteProperty(target, key) &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.deleteProperty(target, key)<span class="comment">//删除成则返回true，否则false</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'delete property'</span>, key)</span><br><span class="line">        <span class="comment">// console.log('result', result) // true</span></span><br><span class="line">        <span class="keyword">return</span> result <span class="comment">// 是否删除成功</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="comment">// 对象的测试</span></span><br><span class="line"><span class="comment">// proxyData.age  //触发get, 打印结果：get age</span></span><br><span class="line"><span class="comment">// proxyData.age = 30 //触发set, 打印结果set age 30</span></span><br><span class="line"><span class="comment">// delete proxyData.age //触发deleteProperty,打印结果delete property age</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组的测试</span></span><br><span class="line"><span class="comment">// proxyData.push('100')</span></span><br><span class="line"><span class="comment">// 1 不去重的情况（多次触发get和set）</span></span><br><span class="line"><span class="comment">// 打印结果</span></span><br><span class="line"><span class="comment">// get push  调用push函数时会先触发get获取push属性</span></span><br><span class="line"><span class="comment">// get length  再次触发get 获取length属性</span></span><br><span class="line"><span class="comment">// set 3 100    触发set 完成添加新属性</span></span><br><span class="line"><span class="comment">// set length 4  再次触发set 完成length的更新</span></span><br><span class="line"><span class="comment">// 2 去重的情况（在get中判断是获取本身属性才触发打印，在set中判断是不是重复设置才打印）</span></span><br><span class="line"><span class="comment">// 打印结果</span></span><br><span class="line"><span class="comment">// get length  length是本身的属性，所以会触发打印</span></span><br><span class="line"><span class="comment">// set 3 100</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Reflect作用<ul>
<li>和Proxy能力一一对应</li>
<li>规范化、标准化、函数式</li>
<li>替代掉Object上的工具函数, 让Object成为一个存粹的数据结构</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Reflect.ownKeys()获取数组或对象的直接属性，即非原型属性</span></span><br><span class="line"><span class="keyword">let</span> target = [<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>]</span><br><span class="line">condole.log(<span class="built_in">Reflect</span>.ownKeys(target))<span class="comment">// ["0", "1", "2", "length"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> target = &#123;<span class="attr">a</span>:<span class="number">10</span>， b:<span class="number">20</span>&#125;</span><br><span class="line">condole.log(<span class="built_in">Reflect</span>.ownKeys(target))<span class="comment">// ["a", "b"]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//理解规范化、标准化、函数式</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">a</span> : <span class="number">100</span>, <span class="attr">b</span> : <span class="number">200</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">'a'</span> <span class="keyword">in</span> obj <span class="comment">//传统写法  </span></span><br><span class="line"><span class="built_in">Reflect</span>.has(obj, <span class="string">'a'</span>) <span class="comment">//Reflect写法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> obj.b <span class="comment">//传统写法 </span></span><br><span class="line"><span class="built_in">Reflect</span>.deleteProperty(obj, <span class="string">'b'</span>)<span class="comment">//Reflect写法</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//替代掉Object上的工具函数</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">a</span> : <span class="number">100</span>, <span class="attr">b</span> : <span class="number">200</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.hasOwnPropertyNames(obj)<span class="comment">//['a','b']</span></span><br><span class="line"><span class="built_in">Reflect</span>.ownKeys(obj)<span class="comment">//['a','b']</span></span><br></pre></td></tr></table></figure>

<h4 id="Proxy实现响应式"><a href="#Proxy实现响应式" class="headerlink" title="Proxy实现响应式"></a>Proxy实现响应式</h4><blockquote>
<p>Proxy结合Reflect可以实现对数组和对象的监听，且可以监听删除和增加新属性，且递归深度监听效率更高，完美解决了vue2中用Object.defineProperty实现响应式的问题</p>
</blockquote>
<ul>
<li><p>深度监听，性能更好，</p>
<ul>
<li>vue2的递归是一开始就递归到底了，</li>
<li>vue3中一开始只监听了data的第一层属性，深层属性在触发get时才递归到底进行监听，</li>
<li>即vue2中一开始就实现了对所有属性的监听，vue3中深层属性在触发get时才进入监听状态</li>
</ul>
</li>
<li><p>可监听新增/删除属性</p>
</li>
<li><p>可监听数组变化，支持数组原生方法</p>
</li>
<li><p>Proxy无法兼容所有浏览器，无法polyfill</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addViewUp</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'新增属性页面更新'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">editViewUp</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'修改属性页面更新'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteViewUp</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'删除属性页面更新'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 创建响应式</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reactive</span>(<span class="params">target = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> target !== <span class="string">'object'</span> || target == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// 不是对象或数组，则返回</span></span><br><span class="line">        <span class="keyword">return</span> target</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 代理配置</span></span><br><span class="line">    <span class="keyword">const</span> proxyConf = &#123;</span><br><span class="line">        <span class="keyword">get</span>(target, key, receiver) &#123;</span><br><span class="line">            <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">        </span><br><span class="line">            <span class="comment">// 只对本身（非原型的）属性进行深度监听</span></span><br><span class="line">            <span class="keyword">const</span> ownKeys = <span class="built_in">Reflect</span>.ownKeys(target)</span><br><span class="line">            <span class="keyword">let</span> deepRes = <span class="literal">null</span></span><br><span class="line">            <span class="keyword">if</span> (ownKeys.includes(key)) &#123;</span><br><span class="line">              <span class="comment">// 深度监听</span></span><br><span class="line">              deepRes = reactive(result)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> deepRes</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">set</span>(target, key, val, receiver) &#123;</span><br><span class="line">            <span class="comment">// 重复的数据，不处理</span></span><br><span class="line">            <span class="keyword">if</span> (val === target[key]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">const</span> ownKeys = <span class="built_in">Reflect</span>.ownKeys(target)</span><br><span class="line">            <span class="keyword">let</span> isNewKey = <span class="literal">true</span> <span class="comment">// 新增key 新增属性</span></span><br><span class="line">            <span class="keyword">if</span> (ownKeys.includes(key)) &#123;</span><br><span class="line">              isNewKey = <span class="literal">false</span>  <span class="comment">// 已有key 修改属性</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.set(target, key, val, receiver)</span><br><span class="line">            <span class="keyword">if</span>(isNewKey)&#123;<span class="comment">//新增属性视图更新</span></span><br><span class="line">              addViewUp()</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;<span class="comment">//修改属性视图更新</span></span><br><span class="line">              editViewUp()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result <span class="comment">// 是否设置成功</span></span><br><span class="line">        &#125;,</span><br><span class="line">        deleteProperty(target, key) &#123;</span><br><span class="line">            <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.deleteProperty(target, key)</span><br><span class="line">            deleteViewUp() <span class="comment">// 删除属性试图更新</span></span><br><span class="line">            <span class="keyword">return</span> result <span class="comment">// 是否删除成功</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成代理对象</span></span><br><span class="line">    <span class="keyword">const</span> observed = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, proxyConf)</span><br><span class="line">    <span class="keyword">return</span> observed</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试数据</span></span><br><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">    name: <span class="string">'zhangsan'</span>,</span><br><span class="line">    age: <span class="number">20</span>,</span><br><span class="line">    info: &#123;</span><br><span class="line">        city: <span class="string">'beijing'</span>,</span><br><span class="line">        a: &#123;</span><br><span class="line">            b: &#123;</span><br><span class="line">                c: &#123;</span><br><span class="line">                    d: &#123;</span><br><span class="line">                        e: <span class="number">100</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成响应式对象</span></span><br><span class="line"><span class="keyword">const</span> proxyData = reactive(data)</span><br><span class="line"><span class="built_in">console</span>.log(proxyData.info.city)</span><br><span class="line">proxyData.info.a.b.c.d.e = <span class="string">'xxxx'</span></span><br><span class="line"><span class="keyword">delete</span> proxyData.name</span><br><span class="line">proxyData.xxx = <span class="string">'xxxx'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印结果</span></span><br><span class="line">beijing</span><br><span class="line">修改属性页面更新</span><br><span class="line">删除属性页面更新</span><br><span class="line">新增属性页面更新</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="watch-和watchEffect"><a href="#watch-和watchEffect" class="headerlink" title="watch 和watchEffect"></a>watch 和watchEffect</h2><p>8 watch 和watchEffect的区别是什么?</p>
<ul>
<li>两者都可监听data属性变化</li>
<li>watch<ul>
<li>需要开发者明确指定监听哪个属性</li>
<li>深度监听时<strong>拿不到旧值</strong>，因为深度监听的对象是引用类型，oldValue和newValue指向同一个地址</li>
</ul>
</li>
<li>watchEffect <ul>
<li>会根据其中的属性，自动监听其变化，即代码块中某个属性变化了就会触发</li>
<li>初始化时，一定会执行一次（收集要监听的数据），类似watch的immediate:为true</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;p&gt;watch vs watchEffect&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;numberRef&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;name&#125;&#125; &#123;&#123;age&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; reactive, ref, toRefs, watch, watchEffect &#125; from &#39;vue&#39;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#39;Watch&#39;,</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const numberRef &#x3D; ref(100)</span><br><span class="line">        const state &#x3D; reactive(&#123;</span><br><span class="line">            name: &#39;chuckie&#39;,</span><br><span class="line">            age: 20,</span><br><span class="line">            a:&#123;</span><br><span class="line">              b:100</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        watchEffect(() &#x3D;&gt; &#123;</span><br><span class="line">            &#x2F;&#x2F; 初始化时，一定会执行一次（收集要监听的数据）</span><br><span class="line">            console.log(&#39;hello watchEffect&#39;)</span><br><span class="line">        &#125;)</span><br><span class="line">        watchEffect(() &#x3D;&gt; &#123;</span><br><span class="line">            console.log(&#39;state.name&#39;, state.name)&#x2F;&#x2F;name变化时触发</span><br><span class="line">            &#x2F;&#x2F; 也可以在这里调用一个函数，函数内部有响应式数据变化也会触发watchEffrctd</span><br><span class="line">        &#125;)</span><br><span class="line">        watchEffect(() &#x3D;&gt; &#123;</span><br><span class="line">            console.log(&#39;state.age&#39;, state.age)&#x2F;&#x2F;age变化时触发</span><br><span class="line">        &#125;)</span><br><span class="line">        watchEffect(() &#x3D;&gt; &#123;</span><br><span class="line">            &#x2F;&#x2F;以下任何一个变量变化都会触发下面的代码执行</span><br><span class="line">            console.log(&#39;state.age&#39;, state.age)</span><br><span class="line">            console.log(&#39;state.name&#39;, state.name)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        watch(numberRef, (newNumber, oldNumber) &#x3D;&gt; &#123;</span><br><span class="line">            console.log(&#39;ref watch&#39;, newNumber, oldNumber)</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; , &#123;</span><br><span class="line">        &#x2F;&#x2F;     immediate: true &#x2F;&#x2F; 初始化之前就监听，可选</span><br><span class="line">        &#x2F;&#x2F; &#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">            numberRef.value &#x3D; 200</span><br><span class="line">        &#125;, 1500)</span><br><span class="line"></span><br><span class="line">        watch(</span><br><span class="line">            &#x2F;&#x2F; 第一个参数，确定要监听哪个属性</span><br><span class="line">            () &#x3D;&gt; state.a,</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 第二个参数，回调函数</span><br><span class="line">            (newAge, oldAge) &#x3D;&gt; &#123;</span><br><span class="line">                console.log(&#39;state watch&#39;, newAge, oldAge)&#x2F;&#x2F;深度监听时，newAge和oldAge的值相同，因为newAge, oldAge是引用类型，指向同一个地址</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 第三个参数，配置项</span><br><span class="line">            &#123;</span><br><span class="line">                immediate: true, &#x2F;&#x2F; 初始化之前就监听，可选</span><br><span class="line">                deep: true &#x2F;&#x2F; 深度监听</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">            state.a.b &#x3D; 25</span><br><span class="line">        &#125;, 1500)</span><br><span class="line"></span><br><span class="line">        return &#123;</span><br><span class="line">            numberRef,</span><br><span class="line">            ...toRefs(state)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="setup获取实例"><a href="#setup获取实例" class="headerlink" title="setup获取实例"></a>setup获取实例</h2><p>9 setup 中如何获取组件实例?</p>
<ul>
<li>在setup和其他Composition API中没有this</li>
<li>可通过<code>getCurrentInstance</code>获取当前实例</li>
<li>若使用Options API可照常使用this</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; onMounted, getCurrentInstance &#125; from &#39;vue&#39;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#39;GetInstance&#39;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            x: 1</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const instance &#x3D; getCurrentInstance()  </span><br><span class="line">        onMounted(() &#x3D;&gt; &#123;</span><br><span class="line">            console.log(&#39;x&#39;, instance.data.x)</span><br><span class="line">        &#125;)  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Vue3为何比-Vue2快"><a href="#Vue3为何比-Vue2快" class="headerlink" title="Vue3为何比 Vue2快"></a>Vue3为何比 Vue2快</h2><p>10 Vue3为何比 Vue2快?</p>
<h4 id="Proxy响应式"><a href="#Proxy响应式" class="headerlink" title="Proxy响应式"></a>Proxy响应式</h4><ul>
<li>深度监听不用在第一次就一次性递归到底，在使用深层属性时才递归并实现监听</li>
</ul>
<h4 id="PatchFlag"><a href="#PatchFlag" class="headerlink" title="PatchFlag"></a>PatchFlag</h4><blockquote>
<p><a href="https://vue-next-template-explorer.netlify.app/" target="_blank" rel="noopener">Vue3模板编译测试工具：Vue3 Template Explorer</a></p>
</blockquote>
<ul>
<li>编译模板时,动态节点做标记，分为不同的类型,如TEXT、 PROPS、CLASS等<ul>
<li>动态节点:  有插值表达式（有变量需要vue底层处理）的节点</li>
<li>静态节点：纯写死的节点，没有变量需要处理</li>
</ul>
</li>
</ul>
<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210810182640295.png" alt="image-20210810182640295"></p>
<ul>
<li>diff算法时，可以区分静态节点,以及不同类型的动态节点，从而优化diff算法<ul>
<li>只有标记了PatchFlag的vnode才进行比对</li>
</ul>
</li>
</ul>
<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20210810181939993.png" alt="image-20210810181939993"></p>
<h4 id="hoistStatic"><a href="#hoistStatic" class="headerlink" title="hoistStatic"></a>hoistStatic</h4><ul>
<li>将静态节点的定义,提升到父作用域,缓存起来（空间换时间）</li>
<li>多个(到一定的阈值后才会合并)相邻的静态节点,会被合并起来（编译优化）</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">:id</span>= <span class="string">"ids"</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> _hoisted_1 = <span class="comment">/*#__PURE__*/</span>_createElementVNode(<span class="string">"div"</span>, <span class="literal">null</span>, <span class="string">"Hello World"</span>, <span class="number">-1</span> <span class="comment">/* HOISTED */</span>)  <span class="comment">// 静态节点缓存起来</span></span><br><span class="line"><span class="keyword">const</span> _hoisted_2 = <span class="comment">/*#__PURE__*/</span>_createElementVNode(<span class="string">"div"</span>, <span class="literal">null</span>, <span class="string">"Hello World"</span>, <span class="number">-1</span> <span class="comment">/* HOISTED */</span>)</span><br><span class="line"><span class="keyword">const</span> _hoisted_3 = <span class="comment">/*#__PURE__*/</span>_createElementVNode(<span class="string">"div"</span>, <span class="literal">null</span>, <span class="string">"Hello World"</span>, <span class="number">-1</span> <span class="comment">/* HOISTED */</span>)</span><br><span class="line"><span class="keyword">const</span> _hoisted_4 = [<span class="string">"id"</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createElementBlock(<span class="string">"div"</span>, <span class="literal">null</span>, [</span><br><span class="line">    _hoisted_1,  <span class="comment">// 静态节点缓存起来</span></span><br><span class="line">    _hoisted_2,</span><br><span class="line">    _hoisted_3,</span><br><span class="line">    _createElementVNode(<span class="string">"div"</span>, &#123; <span class="attr">id</span>: _ctx.ids &#125;, _toDisplayString(_ctx.msg), <span class="number">9</span> <span class="comment">/* TEXT, PROPS */</span>, _hoisted_4)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="cacheHandler"><a href="#cacheHandler" class="headerlink" title="cacheHandler"></a>cacheHandler</h4><ul>
<li>缓存事件（空间换时间），每次执行render函数生成vnode时不用重新定义函数</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">"clickHander"</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">_ctx, _cache, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_openBlock(), _createElementBlock(<span class="string">"div"</span>, <span class="literal">null</span>, [</span><br><span class="line">    _createElementVNode(<span class="string">"div"</span>, &#123;</span><br><span class="line">      onClick: _cache[<span class="number">0</span>] || <span class="function">(<span class="params">_cache[<span class="number">0</span>] = (...args</span>) =&gt;</span> (_ctx.clickHander &amp;&amp; _ctx.clickHander(...args)))</span><br><span class="line">    &#125;, <span class="string">"Hello World"</span>)</span><br><span class="line">  ]))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="tree-shaking"><a href="#tree-shaking" class="headerlink" title="tree-shaking"></a>tree-shaking</h4><ul>
<li>模板编译时,根据不同的情况，引入不同的API（从vue中引入的进行模板编译的API），需要使用才引入</li>
</ul>
<h4 id="SSR-优化"><a href="#SSR-优化" class="headerlink" title="SSR 优化"></a>SSR 优化</h4><blockquote>
<p>使用SSR时就不能使用hoistStatic、cacheHandler</p>
</blockquote>
<ul>
<li>静态节点直接输出,绕过了vdom，即静态节点直接转换成了字符串  （编译优化）</li>
<li>动态节点,还是需要动态渲染</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> &gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> &gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> &gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">"clickHander"</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mergeProps <span class="keyword">as</span> _mergeProps &#125; <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line"><span class="keyword">import</span> &#123; ssrRenderAttrs <span class="keyword">as</span> _ssrRenderAttrs &#125; <span class="keyword">from</span> <span class="string">"vue/server-renderer"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">ssrRender</span>(<span class="params">_ctx, _push, _parent, _attrs, $props, $setup, $data, $options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> _cssVars = &#123; <span class="attr">style</span>: &#123; <span class="attr">color</span>: _ctx.color &#125;&#125;</span><br><span class="line">  _push(<span class="string">`&lt;div<span class="subst">$&#123;_ssrRenderAttrs(_mergeProps(_attrs, _cssVars))&#125;</span>&gt;&lt;div&gt;Hello World&lt;/div&gt;&lt;div&gt;Hello World&lt;/div&gt;&lt;div&gt;Hello World&lt;/div&gt;&lt;div&gt;Hello World&lt;/div&gt;&lt;/div&gt;`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Vite"><a href="#Vite" class="headerlink" title="Vite"></a>Vite</h2><p>11 Vite是什么?</p>
<ul>
<li>一个前端打包工具，Vue作者发起的项目</li>
<li>借助Vue的影响力，发展较快，和webpack竞争</li>
<li>优势:开发环境下无需打包，启动快<ul>
<li>开发环境使用ES6 Module ，无需打包（不用转成es5）—-非常快</li>
<li>生产环境使用rollup ，并不会快很多</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ES Module demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>基本演示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 通过直接在script中插入module的方式就可以使用，ES6 Module --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">import</span> &#123; add, multi &#125; <span class="keyword">from</span> <span class="string">'./src/math.js'</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'add res'</span>, add(<span class="number">10</span>, <span class="number">20</span>))</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'multi res'</span>, multi(<span class="number">10</span>, <span class="number">20</span>))</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ES6-module"><a href="#ES6-module" class="headerlink" title="ES6 module"></a>ES6 module</h4><blockquote>
<p>案例代码： L231-es-module-demo</p>
<ul>
<li>基本使用</li>
<li>外链引入</li>
<li>动态引入</li>
<li>远程引入</li>
</ul>
</blockquote>
<p><strong>核心点：</strong></p>
<ul>
<li>直接将代码通过ES6 Module的方式引入，不需要转换为ES5后再执行</li>
</ul>
<h2 id="Composition-API和React-Hooks"><a href="#Composition-API和React-Hooks" class="headerlink" title="Composition API和React Hooks"></a>Composition API和React Hooks</h2><p>12 Composition API和 React Hooks的对比</p>
<ul>
<li>前者setup只会被调用一次，而后者函数组件会被多次调用</li>
<li>前者无需useMemo（缓存数据） useCallback（缓存函数） ，因为setup只调用一次</li>
<li>前者无需顾虑调用顺序，而后者需要保证hooks的顺序一致</li>
<li>前者reactive + ref比后者useState ，要难理解</li>
</ul>
<h1 id="三、React"><a href="#三、React" class="headerlink" title="三、React"></a>三、React</h1><blockquote>
<ul>
<li><p>？</p>
<ul>
<li><p>bind this</p>
</li>
<li><p>父子通信，子组件调用父组件方法</p>
</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<p><a href="https://chuckiewill.github.io/categories/react/" target="_blank" rel="noopener">Chuckie’s Blog-React</a></p>
</blockquote>
<ul>
<li>React 组件如何通讯</li>
<li>JSX本质是什么</li>
<li>context是什么，有何用途?</li>
<li>shouldComponentUpdate的用途</li>
<li>描述redux单项数据流 (手写流程图)</li>
<li>setState是同步还是异步</li>
</ul>
<h2 id="React使用"><a href="#React使用" class="headerlink" title="React使用"></a>React使用</h2><h3 id="React基础知识点"><a href="#React基础知识点" class="headerlink" title="React基础知识点"></a>React基础知识点</h3><h4 id="JSX基本使用"><a href="#JSX基本使用" class="headerlink" title="JSX基本使用"></a>JSX基本使用</h4><ul>
<li>变量、表达式</li>
<li>class style</li>
<li>子元素和组件</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./style.css'</span></span><br><span class="line"><span class="keyword">import</span> List <span class="keyword">from</span> <span class="string">'../List'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JSXBaseDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            name: <span class="string">'chuckie'</span>,</span><br><span class="line">            imgUrl: <span class="string">'https://img1.mukewang.com/5a9fc8070001a82402060220-140-140.jpg'</span>,</span><br><span class="line">            flag: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">// 获取变量 插值 &#123;&#125;  vs  vue中用&#123;&#123;&#125;&#125;</span></span><br><span class="line">        <span class="keyword">const</span> pElem = <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.state.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">        <span class="keyword">return</span> pElem</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 表达式</span></span><br><span class="line">        <span class="keyword">const</span> exprElem = <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.state.flag ? 'yes' : 'no'&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">        <span class="keyword">return</span> exprElem</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 子元素</span></span><br><span class="line">        <span class="keyword">const</span> imgElem = <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>我的头像<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"xxxx.png"</span>/&gt;</span>  // 静态属性</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;this.state.imgUrl&#125;/</span>&gt;</span>  // 动态属性</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        <span class="keyword">return</span> imgElem</span><br><span class="line"></span><br><span class="line">        <span class="comment">// class</span></span><br><span class="line">        <span class="keyword">const</span> classElem = <span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&#123;this.state.title&#125;</span>&gt;</span>设置 css class<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>  <span class="comment">// 动态属性</span></span><br><span class="line">        <span class="keyword">const</span> classElem = <span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">"title"</span>&gt;</span>设置 css class<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span> <span class="comment">// 静态属性</span></span><br><span class="line">        <span class="keyword">return</span> classElem</span><br><span class="line"></span><br><span class="line">        <span class="comment">// style</span></span><br><span class="line">        <span class="keyword">const</span> styleElem = <span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"fontSize: 30px,  color: blue"</span>&gt;</span>设置 style<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span> <span class="comment">// 静态属性</span></span><br><span class="line">        <span class="keyword">const</span> styleData = &#123; <span class="attr">fontSize</span>: <span class="string">'30px'</span>,  <span class="attr">color</span>: <span class="string">'blue'</span> &#125; </span><br><span class="line">        <span class="keyword">const</span> styleElem = <span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;styleData&#125;</span>&gt;</span>设置 style<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span> <span class="comment">// 动态属性</span></span><br><span class="line">        <span class="comment">// 内联写法，注意 &#123;&#123; 和 &#125;&#125;</span></span><br><span class="line">        <span class="comment">// const styleElem = &lt;p style=&#123;&#123; fontSize: '30px',  color: 'blue' &#125;&#125;&gt;设置 style&lt;/p&gt; // 动态属性</span></span><br><span class="line">        <span class="keyword">return</span> styleElem</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 原生 html</span></span><br><span class="line">        <span class="keyword">const</span> rawHtml = <span class="string">'&lt;span&gt;富文本内容&lt;i&gt;斜体&lt;/i&gt;&lt;b&gt;加粗&lt;/b&gt;&lt;/span&gt;'</span></span><br><span class="line">        <span class="keyword">const</span> rawHtmlData = &#123;</span><br><span class="line">            __html: rawHtml <span class="comment">// 注意，必须是这种格式</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> rawHtmlElem = <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">dangerouslySetInnerHTML</span>=<span class="string">&#123;rawHtmlData&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>  // 解析为html再显示</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;rawHtml&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span> // 不解析直接显示字符串</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        <span class="keyword">return</span> rawHtmlElem</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 加载组件</span></span><br><span class="line">        <span class="keyword">const</span> componentElem = <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>JSX 中加载一个组件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">List</span>/&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        <span class="keyword">return</span> componentElem</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> JSXBaseDemo</span><br></pre></td></tr></table></figure>

<ul>
<li>条件判断<ul>
<li>if else</li>
<li>三元表达式</li>
<li>逻辑运算符<code>&amp;&amp;  ||</code></li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./style.css'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConditionDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            theme: <span class="string">'black'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> blackBtn = <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">"btn-black"</span>&gt;</span>black btn<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">        <span class="keyword">const</span> whiteBtn = <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">"btn-white"</span>&gt;</span>white btn<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// // if else</span></span><br><span class="line">        <span class="comment">// if (this.state.theme === 'black') &#123;</span></span><br><span class="line">        <span class="comment">//     return blackBtn</span></span><br><span class="line">        <span class="comment">// &#125; else &#123;</span></span><br><span class="line">        <span class="comment">//     return whiteBtn</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// // 三元运算符</span></span><br><span class="line">        <span class="comment">// return &lt;div&gt;</span></span><br><span class="line">        <span class="comment">//     &#123; this.state.theme === 'black' ? blackBtn : whiteBtn &#125;</span></span><br><span class="line">        <span class="comment">// &lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// &amp;&amp;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123; this.state.theme === 'black' &amp;&amp; blackBtn &#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ConditionDemo</span><br></pre></td></tr></table></figure>

<ul>
<li>列表渲染<ul>
<li>map</li>
<li>key  和vue中的key类似</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            list: [</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-1'</span>,</span><br><span class="line">                    title: <span class="string">'标题1'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-2'</span>,</span><br><span class="line">                    title: <span class="string">'标题2'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-3'</span>,</span><br><span class="line">                    title: <span class="string">'标题3'</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123; /* vue v-for */</span></span><br><span class="line"><span class="xml">                this.state.list.map(</span></span><br><span class="line"><span class="xml">                    (item, index) =&gt; &#123;</span></span><br><span class="line"><span class="xml">                        // 这里的 key 和 Vue 的 key 类似，必填，不能是 index 或 random</span></span><br><span class="line">                        return &lt;li key=&#123;item.id&#125;&gt;</span><br><span class="line">                            index &#123;index&#125;; id &#123;item.id&#125;; title &#123;item.title&#125;</span><br><span class="line"><span class="xml">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                )</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ListDemo</span><br></pre></td></tr></table></figure>

<h4 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h4><ul>
<li>bind this<ul>
<li>对象普通方法需要使用bind this<ul>
<li>在构造函数中绑定  只用bind一次  性能更高</li>
<li>不要在事件绑定的时候bind  这样每次触发事件都要bind一次 性能低</li>
</ul>
</li>
<li>对象静态方法(箭头函数)不需要使用bind this</li>
</ul>
</li>
<li>关于event参数<ul>
<li>vue中的event是原生事件<ul>
<li>事件被挂载在当前元素上</li>
</ul>
</li>
<li>React中的event是对原生事件封装后的事件<ul>
<li>事件被挂载在document上， 和DOM事件、vue事件都不一样<ul>
<li>React17开始事件不再被挂载到document上了</li>
<li>React17开始事件被挂载到root组件</li>
<li>有利于多个React版本并存,例如微前端</li>
</ul>
</li>
<li>React中通过event.nativeEvent获取原生事件</li>
<li>React封装后的事件模拟出了DOM事件所有能力</li>
</ul>
</li>
</ul>
</li>
<li>传递自定义参数</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            name: <span class="string">'chuckie'</span>,</span><br><span class="line">            list: [</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-1'</span>,</span><br><span class="line">                    title: <span class="string">'标题1'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-2'</span>,</span><br><span class="line">                    title: <span class="string">'标题2'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-3'</span>,</span><br><span class="line">                    title: <span class="string">'标题3'</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 修改方法的 this 指向</span></span><br><span class="line">        <span class="keyword">this</span>.clickHandler1 = <span class="keyword">this</span>.clickHandler1.bind(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">// // this - 使用 bind</span></span><br><span class="line">        <span class="comment">// return &lt;p onClick=&#123;this.clickHandler1&#125;&gt;</span></span><br><span class="line">        <span class="comment">//     &#123;this.state.name&#125;</span></span><br><span class="line">        <span class="comment">// &lt;/p&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// // this - 使用静态方法</span></span><br><span class="line">        <span class="comment">// return &lt;p onClick=&#123;this.clickHandler2&#125;&gt;</span></span><br><span class="line">        <span class="comment">//     clickHandler2 &#123;this.state.name&#125;</span></span><br><span class="line">        <span class="comment">// &lt;/p&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// // event</span></span><br><span class="line">        <span class="comment">// return &lt;a href="https://imooc.com/" onClick=&#123;this.clickHandler3&#125;&gt;</span></span><br><span class="line">        <span class="comment">//     click me</span></span><br><span class="line">        <span class="comment">// &lt;/a&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 传递参数 - 用 bind(this, a, b)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;this.state.list.map((item, index) =&gt; &#123;</span></span><br><span class="line">            return &lt;li key=&#123;item.id&#125; onClick=&#123;this.clickHandler4.bind(this, item.id, item.title)&#125;&gt;</span><br><span class="line">                index &#123;index&#125;; title &#123;item.title&#125;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#125;)&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    clickHandler1() &#123;</span><br><span class="line">        <span class="comment">// console.log('this....', this) // this 默认是 undefined</span></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            name: <span class="string">'lisi'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 静态方法，this 指向当前实例</span></span><br><span class="line">    clickHandler2 = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            name: <span class="string">'lisi'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 获取 event</span></span><br><span class="line">    clickHandler3 = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">        event.preventDefault() <span class="comment">// 阻止默认行为</span></span><br><span class="line">        event.stopPropagation() <span class="comment">// 阻止冒泡</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'target'</span>, event.target) <span class="comment">// 指向当前元素，即当前元素触发</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'current target'</span>, event.currentTarget) <span class="comment">// 指向当前元素，假象！！！</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注意，event 其实是 React 封装的。可以看 __proto__.constructor 是 SyntheticEvent 组合事件</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'event'</span>, event) <span class="comment">// 不是原生的 Event ，原生的是 MouseEvent</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'event.__proto__.constructor'</span>, event.__proto__.constructor)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 原生 event 如下。其 __proto__.constructor 是 MouseEvent</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'nativeEvent'</span>, event.nativeEvent)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'nativeEvent target'</span>, event.nativeEvent.target)  <span class="comment">// 指向当前元素，即当前元素触发</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'nativeEvent current target'</span>, event.nativeEvent.currentTarget) <span class="comment">// 指向 document ！！！ 事件挂载的地方</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. event 是 SyntheticEvent ，模拟出来 DOM 事件所有能力</span></span><br><span class="line">        <span class="comment">// 2. event.nativeEvent 是原生事件对象</span></span><br><span class="line">        <span class="comment">// 3. 所有的事件，都被挂载到 document 上</span></span><br><span class="line">        <span class="comment">// 4. 和 DOM 事件不一样，和 Vue 事件也不一样</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 传递参数</span></span><br><span class="line">    clickHandler4(id, title, event) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(id, title)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'event'</span>, event) <span class="comment">// 最后追加一个参数，即可接收 event</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> EventDemo</span><br></pre></td></tr></table></figure>

<h4 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h4><ul>
<li>受控组件<ul>
<li>可以理解为双向数据绑定</li>
</ul>
</li>
<li>input textarea select用value</li>
<li>checkbox radio用checked</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FormDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            name: <span class="string">'chuckie'</span>,</span><br><span class="line">            info: <span class="string">'个人信息'</span>,</span><br><span class="line">            city: <span class="string">'beijing'</span>,</span><br><span class="line">            flag: <span class="literal">true</span>,</span><br><span class="line">            gender: <span class="string">'male'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// // 受控组件（非受控组件，后面再讲）</span></span><br><span class="line">        <span class="comment">// return &lt;div&gt;</span></span><br><span class="line">        <span class="comment">//     &lt;p&gt;&#123;this.state.name&#125;&lt;/p&gt;</span></span><br><span class="line">        <span class="comment">//     &lt;label htmlFor="inputName"&gt;姓名：&lt;/label&gt; &#123;/* 用 htmlFor 代替 for */&#125;</span></span><br><span class="line">        <span class="comment">//     &lt;input id="inputName" value=&#123;this.state.name&#125; onChange=&#123;this.onInputChange&#125;/&gt;</span></span><br><span class="line">        <span class="comment">// &lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// textarea - 使用 value</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123;/* <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">onChange</span>=<span class="string">&#123;this.onTextareaChange&#125;</span>&gt;</span>&#123;this.state.info&#125;<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span>  这种方式是错误的，要用value属性 */&#125;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">value</span>=<span class="string">&#123;this.state.info&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.onTextareaChange&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.state.info&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// select - 使用 value</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line">            &lt;select value=&#123;this.state.city&#125; onChange=&#123;this.onSelectChange&#125;&gt;</span><br><span class="line">                &lt;option value="beijing"&gt;北京&lt;/option&gt;</span><br><span class="line">                &lt;option value="shanghai"&gt;上海&lt;/option&gt;</span><br><span class="line">                &lt;option value="shenzhen"&gt;深圳&lt;/option&gt;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.state.city&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// checkbox - 使用checked</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span>=<span class="string">&#123;this.state.flag&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.onCheckboxChange&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.state.flag.toString()&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// radio - 使用checked</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            male <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"male"</span> <span class="attr">checked</span>=<span class="string">&#123;this.state.gender</span> === <span class="string">'male'</span>&#125; <span class="attr">onChange</span>=<span class="string">&#123;this.onRadioChange&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            female <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"female"</span> <span class="attr">checked</span>=<span class="string">&#123;this.state.gender</span> === <span class="string">'female'</span>&#125; <span class="attr">onChange</span>=<span class="string">&#123;this.onRadioChange&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.state.gender&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 非受控组件 - 后面再讲</span></span><br><span class="line">    &#125;</span><br><span class="line">    onInputChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            name: e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    onTextareaChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            info: e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    onSelectChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            city: e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    onCheckboxChange = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            flag: !<span class="keyword">this</span>.state.flag</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    onRadioChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            gender: e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> FormDemo</span><br></pre></td></tr></table></figure>

<h4 id="组件使用"><a href="#组件使用" class="headerlink" title="组件使用"></a>组件使用</h4><ul>
<li>props传递数据</li>
<li>props传递函数</li>
<li>props类型检查</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Input</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            title: <span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;this.state.title&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.onTitleChange&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.onSubmit&#125;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    onTitleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            title: e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    onSubmit = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; submitTitle &#125; = <span class="keyword">this</span>.props <span class="comment">// 拿到父组件的方法</span></span><br><span class="line">        submitTitle(<span class="keyword">this</span>.state.title) <span class="comment">// 调用父组件的方法将参数传递给父组件</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            title: <span class="string">''</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// props 类型检查</span></span><br><span class="line">Input.propTypes = &#123;</span><br><span class="line">    submitTitle: PropTypes.func.isRequired</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; list &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;list.map((item, index) =&gt; &#123;</span></span><br><span class="line">            return &lt;li key=&#123;item.id&#125;&gt;</span><br><span class="line">                &lt;span&gt;&#123;item.title&#125;&lt;/span&gt;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#125;)&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// props 类型检查</span></span><br><span class="line">List.propTypes = &#123;</span><br><span class="line">    list: PropTypes.arrayOf(PropTypes.object).isRequired</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoListDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="comment">// 状态（数据）提升</span></span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            list: [</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-1'</span>,</span><br><span class="line">                    title: <span class="string">'标题1'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-2'</span>,</span><br><span class="line">                    title: <span class="string">'标题2'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-3'</span>,</span><br><span class="line">                    title: <span class="string">'标题3'</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Input</span> <span class="attr">submitTitle</span>=<span class="string">&#123;this.onSubmitTitle&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">List</span> <span class="attr">list</span>=<span class="string">&#123;this.state.list&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 传递给子组件的方法</span></span><br><span class="line">    onSubmitTitle = <span class="function">(<span class="params">title</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            list: <span class="keyword">this</span>.state.list.concat(&#123;</span><br><span class="line">                id: <span class="string">`id-<span class="subst">$&#123;<span class="built_in">Date</span>.now()&#125;</span>`</span>,</span><br><span class="line">                title</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> TodoListDemo</span><br></pre></td></tr></table></figure>

<h4 id="setState"><a href="#setState" class="headerlink" title="setState"></a>setState</h4><ul>
<li>不可变值 （赋值前不能修改原state, 对数组的操作都要是纯函数操作）</li>
<li>可能是异步更新 （传入对象或函数都是以下情况）<ul>
<li>正常使用是异步更新state，需要在回调函数中才能拿到state新值</li>
<li>同步更新情况<ul>
<li>setTimeout 中 setState 是同步的</li>
<li>自己定义的 DOM 事件，setState 是同步的，例如在 componentDidMount 中自定义的事件</li>
</ul>
</li>
</ul>
</li>
<li>可能会被合并<ul>
<li>传入对象会合并</li>
<li>传入函数不会合并</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数组件（后面会讲），默认没有 state</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StateDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 第一，state 要在构造函数中定义</span></span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            count: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.state.count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.increase&#125;</span>&gt;</span>累加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    increase = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 第二，不要直接修改 state ，使用不可变值 ----------------------------</span></span><br><span class="line">        <span class="comment">// this.state.count++ // 错误</span></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            count: <span class="keyword">this</span>.state.count + <span class="number">1</span> <span class="comment">// SCU</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 操作数组、对象的的常用形式，最下面有举例</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 第三，setState 可能是异步更新（有可能是同步更新） ----------------------------</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            count: <span class="keyword">this</span>.state.count + <span class="number">1</span></span><br><span class="line">        &#125;, () =&gt; &#123;</span><br><span class="line">            <span class="comment">// 联想 Vue $nextTick - DOM</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'count by callback'</span>, <span class="keyword">this</span>.state.count) <span class="comment">// 回调函数中可以拿到最新的 state，此时打印的是1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'count'</span>, <span class="keyword">this</span>.state.count) <span class="comment">// 异步的，拿不到最新值，此时打印的还是0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// setTimeout 中 setState 是同步的</span></span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                count: <span class="keyword">this</span>.state.count + <span class="number">1</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'count in setTimeout'</span>, <span class="keyword">this</span>.state.count)</span><br><span class="line">        &#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 自己定义的 DOM 事件，setState 是同步的。再 componentDidMount 中</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 第四，state 异步更新的话，更新前会被合并 ----------------------------</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 传入对象，会被合并（类似 Object.assign ）。执行结果只一次 +1</span></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            count: <span class="keyword">this</span>.state.count + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            count: <span class="keyword">this</span>.state.count + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            count: <span class="keyword">this</span>.state.count + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 传入函数，不会被合并。执行结果是 +3</span></span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                count: prevState.count + <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                count: prevState.count + <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                count: prevState.count + <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    bodyClickHandler = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            count: <span class="keyword">this</span>.state.count + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'count in body event'</span>, <span class="keyword">this</span>.state.count)</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        <span class="comment">// 自己定义的 DOM 事件，setState 是同步的</span></span><br><span class="line">        <span class="built_in">document</span>.body.addEventListener(<span class="string">'click'</span>, <span class="keyword">this</span>.bodyClickHandler)</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillUnmount() &#123;</span><br><span class="line">        <span class="comment">// 及时销毁自定义 DOM 事件</span></span><br><span class="line">        <span class="built_in">document</span>.body.removeEventListener(<span class="string">'click'</span>, <span class="keyword">this</span>.bodyClickHandler)</span><br><span class="line">        <span class="comment">// clearTimeout</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> StateDemo</span><br><span class="line"></span><br><span class="line"><span class="comment">// -------------不要直接修改 state ，使用不可变值，数组和对象的处理------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 不可变值（函数式编程，纯函数） - 数组</span></span><br><span class="line"><span class="keyword">const</span> list5Copy = <span class="keyword">this</span>.state.list5.slice() <span class="comment">// 深拷贝</span></span><br><span class="line">list5Copy.splice(<span class="number">2</span>, <span class="number">0</span>, <span class="string">'a'</span>) <span class="comment">// 中间插入/删除</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;</span><br><span class="line">    list1: <span class="keyword">this</span>.state.list1.concat(<span class="number">100</span>), <span class="comment">// 追加</span></span><br><span class="line">    list2: [...this.state.list2, <span class="number">100</span>], <span class="comment">// 追加</span></span><br><span class="line">    list3: <span class="keyword">this</span>.state.list3.slice(<span class="number">0</span>, <span class="number">3</span>), <span class="comment">// 截取</span></span><br><span class="line">    list4: <span class="keyword">this</span>.state.list4.filter(<span class="function"><span class="params">item</span> =&gt;</span> item &gt; <span class="number">100</span>), <span class="comment">// 筛选</span></span><br><span class="line">    list5: list5Copy <span class="comment">// 其他操作</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 注意，不能直接对 this.state.list 进行 push pop splice 等，这样违反不可变值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 不可变值 - 对象</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;</span><br><span class="line">    obj1: <span class="built_in">Object</span>.assign(&#123;&#125;, <span class="keyword">this</span>.state.obj1, &#123;<span class="attr">a</span>: <span class="number">100</span>&#125;),</span><br><span class="line">    obj2: &#123;...this.state.obj2, <span class="attr">a</span>: <span class="number">100</span>&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 注意，不能直接对 this.state.obj 进行属性设置，这样违反不可变值</span></span><br></pre></td></tr></table></figure>

<h4 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h4><blockquote>
<p>以下是React17(含)以后的生命周期函数</p>
</blockquote>
<ul>
<li><code>componentDidMount()</code>  对应于vue中<code>mounted()</code></li>
<li><code>componentDidUpdate()</code>对应于vue中<code>updated()</code></li>
<li><code>componentWillUnmount()</code>对应于vue中<code>beforeUnmount()</code></li>
</ul>
<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20220824101337489.png" alt="image-20220824101337489"></p>
<ul>
<li><code>shouldComponentUpdate()</code></li>
</ul>
<p><img src="/2021/07/27/Index/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95/image-20220824101239949.png" alt="image-20220824101239949"></p>
<h3 id="React高级特性"><a href="#React高级特性" class="headerlink" title="React高级特性"></a>React高级特性</h3><h4 id="函数组件"><a href="#函数组件" class="headerlink" title="函数组件"></a>函数组件</h4><ul>
<li>纯函数,输入props, 输出JSX</li>
<li>没有实例,没有生命周期,没有state，<strong>减少了性能的消耗，性能更高</strong></li>
<li>不能扩展其他方法</li>
</ul>
<h4 id="非受控组件"><a href="#非受控组件" class="headerlink" title="非受控组件"></a>非受控组件</h4><blockquote>
<p>受控组件：自己实现双向绑定，通过state就可以拿到节点变化的value</p>
<p>非受控组件：state只是给节点赋初始值，后续节点value的变化与state无关，也就是不受state控制，如果要拿到节点变化的value只能在ref的配合下通过DOM拿到节点，再拿到实时变化的value</p>
<p>非受控组件使用场景：</p>
<ul>
<li>必须手动操作DOM元素, setState实现不了</li>
<li>文件上传<code>&lt;input type=file&gt;</code></li>
<li>某些富文本编辑器,需要传入DOM元素</li>
</ul>
</blockquote>
<ul>
<li>ref<ul>
<li>类似vue中的ref，用于获取指定dom节点</li>
</ul>
</li>
<li>defaultValue defaultChecked<ul>
<li>给dom节点赋初始值</li>
<li>input textarea select给value赋值时要用defaultValue </li>
<li>checkbox radio给checked赋值时要用defaultChecked</li>
</ul>
</li>
<li>手动操作DOM元素<ul>
<li>获取dom节点的实时vaule</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            name: <span class="string">'chuckie'</span>,</span><br><span class="line">            flag: <span class="literal">true</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.nameInputRef = React.createRef() <span class="comment">// 创建 ref</span></span><br><span class="line">        <span class="keyword">this</span>.fileInputRef = React.createRef()</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">// input defaultValue</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123;/* 使用 defaultValue 而不是 value ，使用 ref */&#125;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">defaultValue</span>=<span class="string">&#123;this.state.name&#125;</span> <span class="attr">ref</span>=<span class="string">&#123;this.nameInputRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123;/* state 并不会随着改变 */&#125;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>state.name: &#123;this.state.name&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.alertName&#125;</span>&gt;</span>alert name<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// checkbox defaultChecked</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line">            &lt;input</span><br><span class="line">                type="checkbox"</span><br><span class="line">                defaultChecked=&#123;this.state.flag&#125;</span><br><span class="line"><span class="xml">            /&gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// file</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">ref</span>=<span class="string">&#123;this.fileInputRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.alertFile&#125;</span>&gt;</span>alert file<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    alertName = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> elem = <span class="keyword">this</span>.nameInputRef.current <span class="comment">// 通过 ref 获取 DOM 节点</span></span><br><span class="line">        alert(elem.value) <span class="comment">// 不是 this.state.name  而是dom节点实时变化的value</span></span><br><span class="line">    &#125;</span><br><span class="line">    alertFile = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> elem = <span class="keyword">this</span>.fileInputRef.current <span class="comment">// 通过 ref 获取 DOM 节点</span></span><br><span class="line">        alert(elem.files[<span class="number">0</span>].name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>



<h4 id="Portals"><a href="#Portals" class="headerlink" title="Portals"></a>Portals</h4><blockquote>
<p>传送门，类似vue中Teleport</p>
</blockquote>
<ul>
<li>核心API: <code>ReactDOM.createPortal(模板，挂载的目标节点)</code></li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PortalsDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">// // 正常渲染</span></span><br><span class="line">        <span class="comment">// return &lt;div className="modal"&gt;</span></span><br><span class="line">        <span class="comment">//     &#123;this.props.children&#125; &#123;/* 类似vue slot，this.props.children即是父组件传入的内容  */&#125;</span></span><br><span class="line">        <span class="comment">// &lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用 Portals 渲染到 body 上。</span></span><br><span class="line">        <span class="comment">// fixed 元素要放在 body 上，有更好的浏览器兼容性。</span></span><br><span class="line">        <span class="keyword">return</span> ReactDOM.createPortal(</span><br><span class="line">            &lt;div className=<span class="string">"modal"</span>&gt;&#123;<span class="keyword">this</span>.props.children&#125;&lt;<span class="regexp">/div&gt;,</span></span><br><span class="line"><span class="regexp">            document.body /</span><span class="regexp">/ 挂载的目标DOM节点</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default PortalsDemo</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 父组件使用</span></span><br><span class="line"><span class="regexp"> &lt;PortalsDemo&gt;Modal 内容&lt;/</span>PortalsDemo&gt;</span><br></pre></td></tr></table></figure>



<h4 id="context"><a href="#context" class="headerlink" title="context"></a>context</h4><blockquote>
<p>使用场景：公共信息(语言、主题)传递给每个组件</p>
<p>不使用的原因：</p>
<ul>
<li>用props多层传递太繁琐</li>
<li>用redux小题大做</li>
</ul>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 Context 填入默认值（任何一个 js 变量）</span></span><br><span class="line"><span class="keyword">const</span> ThemeContext = React.createContext(<span class="string">'light'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 底层组件 - 函数是组件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ThemeLink</span> (<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// const theme = this.context // 会报错。函数式组件没有实例，即没有 this</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 函数式组件可以使用 Consumer 获取context属性的变化</span></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ThemeContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#123; value =&gt; <span class="tag">&lt;<span class="name">p</span>&gt;</span>link's theme is &#123;value&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ThemeContext.Consumer</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 底层组件 - class 组件</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThemedButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 指定 contextType 读取当前的 theme context。</span></span><br><span class="line">    <span class="comment">// static contextType = ThemeContext // 也可以用 ThemedButton.contextType = ThemeContext</span></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> theme = <span class="keyword">this</span>.context <span class="comment">// React 会往上找到最近的 theme Provider，然后使用它的值。</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>button's theme is &#123;theme&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ThemedButton.contextType = ThemeContext <span class="comment">// 指定 contextType 读取当前的 theme context。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 中间的组件再也不必指明往下传递 theme 了。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Toolbar</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;ThemedButton /&gt;</span><br><span class="line">            &lt;ThemeLink /&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 顶层组件</span></span><br><span class="line"><span class="regexp">class App extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">    constructor(props) &#123;</span></span><br><span class="line"><span class="regexp">        super(props)</span></span><br><span class="line"><span class="regexp">        this.state = &#123;</span></span><br><span class="line"><span class="regexp">            theme: 'light'</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    render() &#123;</span></span><br><span class="line"><span class="regexp">        return &lt;ThemeContext.Provider value=&#123;this.state.theme&#125;&gt;</span></span><br><span class="line"><span class="regexp">            &lt;Toolbar /</span>&gt;</span><br><span class="line">            &lt;hr/&gt;</span><br><span class="line">            &lt;button onClick=&#123;<span class="keyword">this</span>.changeTheme&#125;&gt;change theme&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>ThemeContext.Provider&gt;</span><br><span class="line">    &#125;</span><br><span class="line">    changeTheme = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            theme: <span class="keyword">this</span>.state.theme === <span class="string">'light'</span> ? <span class="string">'dark'</span> : <span class="string">'light'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>



<h4 id="异步组件-1"><a href="#异步组件-1" class="headerlink" title="异步组件"></a>异步组件</h4><ul>
<li>import()</li>
<li>React.lazy</li>
<li>React.Suspense  和vue中的Suspense 类似</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ContextDemo = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./ContextDemo'</span>)) <span class="comment">// 引入异步组件</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>引入一个动态组件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="xml">            &#123;/* fallbac是默认展示的效果 */&#125;</span></span><br><span class="line">            &lt;React.Suspense fallback=&#123;&lt;div&gt;Loading...&lt;/div&gt;&#125;&gt; </span><br><span class="line">                &lt;ContextDemo/&gt;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">React.Suspense</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. 强制刷新，可看到 loading （看不到就限制一下 chrome 网速）</span></span><br><span class="line">        <span class="comment">// 2. 看 network 的 js 加载</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure>

<h4 id="高阶组件HOC"><a href="#高阶组件HOC" class="headerlink" title="高阶组件HOC"></a>高阶组件HOC</h4><blockquote>
<p>逻辑抽离</p>
</blockquote>
<p>使用</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//高阶组件不是一种功能，而是一种模式</span></span><br><span class="line"><span class="keyword">const</span> HOCFactory = <span class="function">(<span class="params">Component</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">HOC</span> <span class="keyword">extends</span> <span class="title">React</span>. <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">//在此定义多个组件的公共逻辑</span></span><br><span class="line">    render()&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...</span> <span class="attr">this.props</span>&#125; /&gt;</span></span> <span class="comment">//返回拼装的结果</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> HOC</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> EnhancedComponent1 = HOCFactory (WrappedComponent1)</span><br><span class="line"><span class="keyword">const</span> EnhancedComponent2 = HOCFactory (WrappedComponent2)</span><br></pre></td></tr></table></figure>

<p>案例: 获取鼠标位置的公共需求</p>
<ul>
<li>withMouse中实现获取鼠标位置的功能</li>
<li>哪个组件需要使用这个功能，调用withMouse，并将组件自己传入，返回的则是加上这个功能后的组件</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 高阶组件</span></span><br><span class="line"><span class="keyword">const</span> withMouse = <span class="function">(<span class="params">Component</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">withMouseComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">            <span class="keyword">super</span>(props)</span><br><span class="line">            <span class="keyword">this</span>.state = &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        handleMouseMove = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                x: event.clientX,</span><br><span class="line">                y: event.clientY</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">return</span> (</span><br><span class="line">                &lt;div style=&#123;&#123; <span class="attr">height</span>: <span class="string">'500px'</span> &#125;&#125; onMouseMove=&#123;<span class="keyword">this</span>.handleMouseMove&#125;&gt;</span><br><span class="line">                    &#123;<span class="comment">/* 1. 透传所有 props 2. 增加 mouse 属性 */</span>&#125;</span><br><span class="line">                    &lt;Component &#123;...this.props&#125; mouse=&#123;<span class="keyword">this</span>.state&#125;/&gt;</span><br><span class="line">                &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">            )</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    return withMouseComponent</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const App = (props) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">    const a = props.a</span></span><br><span class="line"><span class="regexp">    const &#123; x, y &#125; = props.mouse /</span><span class="regexp">/ 接收 mouse 属性</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">        &lt;div style=&#123;&#123; height: '500px' &#125;&#125;&gt;</span></span><br><span class="line"><span class="regexp">            &lt;h1&gt;The mouse position is (&#123;x&#125;, &#123;y&#125;)&lt;/</span>h1&gt;</span><br><span class="line">            &lt;p&gt;&#123;a&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withMouse(App) <span class="comment">// 返回高阶函数</span></span><br></pre></td></tr></table></figure>



<h4 id="Render-Props"><a href="#Render-Props" class="headerlink" title="Render Props"></a>Render Props</h4><blockquote>
<p>逻辑抽离</p>
</blockquote>
<p>使用</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Render Props 的核心思想</span></span><br><span class="line"><span class="comment">//通过一个函数将class 组件的state 作为props 传递给纯函数组件</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Factory</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">    <span class="comment">/* state 即多个组件的公共逻辑的数据*/</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*修改state*/</span></span><br><span class="line">  render()&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;this.praps.render(this.state)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span>=&gt;</span>(</span><br><span class="line">  &lt;Factory render=&#123; </span><br><span class="line">  <span class="comment">/* render 是一个函数组件*/</span></span><br><span class="line">    (props) =&gt; <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;props.a&#125; &#123;props.b&#125; ...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">  &#125;/&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>案例</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mouse</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    handleMouseMove = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">        x: event.clientX,</span><br><span class="line">        y: event.clientY</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;div style=&#123;&#123; <span class="attr">height</span>: <span class="string">'500px'</span> &#125;&#125; onMouseMove=&#123;<span class="keyword">this</span>.handleMouseMove&#125;&gt;</span><br><span class="line">            &#123;<span class="comment">/* 将当前 state 作为 props ，传递给 render （render 是一个函数组件） */</span>&#125;</span><br><span class="line">            &#123;<span class="keyword">this</span>.props.render(<span class="keyword">this</span>.state)&#125;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">Mouse.propTypes = &#123;</span></span><br><span class="line"><span class="regexp">    render: PropTypes.func.isRequired /</span><span class="regexp">/ 必须接收一个 render 属性，而且是函数</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const App = (props) =&gt; (</span></span><br><span class="line"><span class="regexp">    &lt;div style=&#123;&#123; height: '500px' &#125;&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &lt;p&gt;&#123;props.a&#125;&lt;/</span>p&gt;</span><br><span class="line">        &lt;Mouse render=&#123;</span><br><span class="line">            <span class="comment">/* render 是一个函数组件 */</span></span><br><span class="line">            (&#123; x, y &#125;) =&gt; <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>The mouse position is (&#123;x&#125;, &#123;y&#125;)<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">        &#125;/&gt;</span><br><span class="line">        </span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span>**</span><br><span class="line"> * 即，定义了 Mouse 组件，只有获取 x y 的能力。</span><br><span class="line"> * 至于 Mouse 组件如何渲染，App 说了算，通过 render prop 的方式告诉 Mouse 。</span><br><span class="line"> *<span class="regexp">/</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App</span></span><br></pre></td></tr></table></figure>



<h3 id="React性能优化"><a href="#React性能优化" class="headerlink" title="React性能优化"></a>React性能优化</h3><h4 id="shouldComponentUpdate-简称SCU"><a href="#shouldComponentUpdate-简称SCU" class="headerlink" title="shouldComponentUpdate (简称SCU )"></a>shouldComponentUpdate (简称SCU )</h4><ul>
<li>SCU默认返回true ，即React默认重新渲染所有子组件</li>
<li>React为什么不直接底层支持比对来避免不必要的渲染，反而要开发者来进行比对，判断是否需要重新渲染<ul>
<li>因为比对必须配合”不可变值”的规则，但不是每个开发者都会遵循这个规则，如果没有遵循这个规则，则会在比对中报错，在报错和性能的抉择中React选择不出错</li>
<li>可先不用SCU ,有性能问题时再考虑使用</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Input</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            title: <span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;this.state.title&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.onTitleChange&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.onSubmit&#125;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    onTitleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            title: e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    onSubmit = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; submitTitle &#125; = <span class="keyword">this</span>.props <span class="comment">// 拿到父组件的方法</span></span><br><span class="line">        submitTitle(<span class="keyword">this</span>.state.title) <span class="comment">// 调用父组件的方法将参数传递给父组件</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            title: <span class="string">''</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// props 类型检查</span></span><br><span class="line">Input.propTypes = &#123;</span><br><span class="line">    submitTitle: PropTypes.func.isRequired</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; list &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;list.map((item, index) =&gt; &#123;</span></span><br><span class="line">            return &lt;li key=&#123;item.id&#125;&gt;</span><br><span class="line">                &lt;span&gt;&#123;item.title&#125;&lt;/span&gt;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#125;)&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// props 类型检查</span></span><br><span class="line">List.propTypes = &#123;</span><br><span class="line">    list: PropTypes.arrayOf(PropTypes.object).isRequired</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Footer</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123;this.props.text&#125;</span></span><br><span class="line"><span class="xml">            &#123;this.props.length&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    componentDidUpdate() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'footer did update'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// shouldComponentUpdate默认返回true</span></span><br><span class="line">    shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nextProps.text !== <span class="keyword">this</span>.props.text</span><br><span class="line">            || nextProps.length !== <span class="keyword">this</span>.props.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span> <span class="comment">// 值有变化才渲染</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span> <span class="comment">// 值没有变化则不重复渲染</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// React 默认：父组件有更新，子组件则无条件也更新！！！</span></span><br><span class="line">    <span class="comment">// 性能优化对于 React 更加重要！</span></span><br><span class="line">    <span class="comment">// SCU 一定要每次都用吗？—— 需要的时候才优化</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoListDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="comment">// 状态（数据）提升</span></span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            list: [</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-1'</span>,</span><br><span class="line">                    title: <span class="string">'标题1'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-2'</span>,</span><br><span class="line">                    title: <span class="string">'标题2'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-3'</span>,</span><br><span class="line">                    title: <span class="string">'标题3'</span></span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            footerInfo: <span class="string">'底部文字'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Input</span> <span class="attr">submitTitle</span>=<span class="string">&#123;this.onSubmitTitle&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">List</span> <span class="attr">list</span>=<span class="string">&#123;this.state.list&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123;/* Footer是静态节点，父组件每次更新其实它是不需要更新的，这里就需要用到shouldComponentUpdate */&#125;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Footer</span> <span class="attr">text</span>=<span class="string">&#123;this.state.footerInfo&#125;</span> <span class="attr">length</span>=<span class="string">&#123;this.state.list.length&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    onSubmitTitle = <span class="function">(<span class="params">title</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            list: <span class="keyword">this</span>.state.list.concat(&#123;</span><br><span class="line">                id: <span class="string">`id-<span class="subst">$&#123;<span class="built_in">Date</span>.now()&#125;</span>`</span>,</span><br><span class="line">                title</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> TodoListDemo</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注意“不可变值”的规则，否则shouldComponentUpdate中比对时就会报错</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span></span><br><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Input</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            title: <span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;this.state.title&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.onTitleChange&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.onSubmit&#125;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    onTitleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            title: e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    onSubmit = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; submitTitle &#125; = <span class="keyword">this</span>.props</span><br><span class="line">        submitTitle(<span class="keyword">this</span>.state.title)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            title: <span class="string">''</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// props 类型检查</span></span><br><span class="line">Input.propTypes = &#123;</span><br><span class="line">    submitTitle: PropTypes.func.isRequired</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; list &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;list.map((item, index) =&gt; &#123;</span></span><br><span class="line">            return &lt;li key=&#123;item.id&#125;&gt;</span><br><span class="line">                &lt;span&gt;&#123;item.title&#125;&lt;/span&gt;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#125;)&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 增加 shouldComponentUpdate</span></span><br><span class="line">    shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line">        <span class="comment">// _.isEqual 做对象或者数组的深度比较（一次性递归到底）</span></span><br><span class="line">        <span class="keyword">if</span> (_.isEqual(nextProps.list, <span class="keyword">this</span>.props.list)) &#123;</span><br><span class="line">            <span class="comment">// 相等，则不重复渲染</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span> <span class="comment">// 不相等，则渲染</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// props 类型检查</span></span><br><span class="line">List.propTypes = &#123;</span><br><span class="line">    list: PropTypes.arrayOf(PropTypes.object).isRequired</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoListDemo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            list: [</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-1'</span>,</span><br><span class="line">                    title: <span class="string">'标题1'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-2'</span>,</span><br><span class="line">                    title: <span class="string">'标题2'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: <span class="string">'id-3'</span>,</span><br><span class="line">                    title: <span class="string">'标题3'</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Input</span> <span class="attr">submitTitle</span>=<span class="string">&#123;this.onSubmitTitle&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">List</span> <span class="attr">list</span>=<span class="string">&#123;this.state.list&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    onSubmitTitle = <span class="function">(<span class="params">title</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 正确的用法</span></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            list: <span class="keyword">this</span>.state.list.concat(&#123;</span><br><span class="line">                id: <span class="string">`id-<span class="subst">$&#123;<span class="built_in">Date</span>.now()&#125;</span>`</span>,</span><br><span class="line">                title</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// // 为了演示 SCU ，故意写的错误用法</span></span><br><span class="line">        <span class="comment">// this.state.list.push(&#123;</span></span><br><span class="line">        <span class="comment">//     id: `id-$&#123;Date.now()&#125;`,</span></span><br><span class="line">        <span class="comment">//     title</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">        <span class="comment">// this.setState(&#123;</span></span><br><span class="line">        <span class="comment">//     list: this.state.list</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> TodoListDemo</span><br></pre></td></tr></table></figure>



<h4 id="PureComponent和React-memo"><a href="#PureComponent和React-memo" class="headerlink" title="PureComponent和React.memo"></a>PureComponent和React.memo</h4><ul>
<li>PureComponent , SCU中实现了浅比较</li>
<li>通过PureComponent 构建的组件，不需要自己定义shouldComponentUpdate，因为已经默认有了shouldComponentUpdate，且对参数做了浅比较，若浅比较相等则返回false，不重复渲染；若浅比较不相等则返回true，重新渲染</li>
<li>浅比较已适用大部分情况(尽量不要做深度比较)</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">PureComponent</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; list &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;list.map((item, index) =&gt; &#123;</span></span><br><span class="line">            return &lt;li key=&#123;item.id&#125;&gt;</span><br><span class="line">                &lt;span&gt;&#123;item.title&#125;&lt;/span&gt;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#125;)&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    shouldComponentUpdate() &#123;<span class="comment">/*浅比较*/</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>memo，函数组件中的PureComponent</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span> (<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* 使用props 渲染*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">areEqual</span>(<span class="params">prevProps,nextProps</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  如果把nextProps 传入render 方法的返回结果与</span></span><br><span class="line"><span class="comment">  将prevProps 传入render 方法的返回结果一致则返回t rue,</span></span><br><span class="line"><span class="comment">  否则返回false</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> React.memo(MyComponent, areEqual) ;</span><br></pre></td></tr></table></figure>



<h4 id="不可变值immutable-js"><a href="#不可变值immutable-js" class="headerlink" title="不可变值immutable.js"></a>不可变值immutable.js</h4><blockquote>
<p>Giuhub地址： <a href="https://github.com/immutable-js/immutable-js" target="_blank" rel="noopener">immutable.js</a></p>
</blockquote>
<ul>
<li>为了配合React中“不可变值”规则的使用，使用<code>immutable.js</code>就可以完全保证开发者时遵循”不可变值”规则的</li>
<li>immutable.js基于共享数据(不是深拷贝) , 速度块</li>
<li>有一定学习和迁移成本,按需使用</li>
</ul>
<h3 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h3><h4 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h4><ul>
<li>store state</li>
<li>action</li>
<li>reducer</li>
</ul>
<h4 id="单项数据流"><a href="#单项数据流" class="headerlink" title="单项数据流"></a>单项数据流</h4><ul>
<li>dispatch(action)</li>
<li>reducer -&gt; newState</li>
<li>subscribe触发通知</li>
</ul>
<h4 id="react-redux"><a href="#react-redux" class="headerlink" title="react- redux"></a>react- redux</h4><ul>
<li><code>&lt; Provider&gt; connect</code></li>
<li>connect</li>
<li>mapStateT oProps mapDispatchToProps</li>
</ul>
<p>异步action<br>中间件</p>
<h3 id="React-router"><a href="#React-router" class="headerlink" title="React-router"></a>React-router</h3><h1 id="四、webpack"><a href="#四、webpack" class="headerlink" title="四、webpack"></a>四、webpack</h1><ul>
<li>前端代码为何要进行构建和打包?</li>
<li>module chunk bundle分别什么意思，有何区别?</li>
<li>loader和plugin 的区别?</li>
<li>webpack 如何实现懒加载?</li>
<li>webpack常见性能优化</li>
<li>babel-runtime和 babel-polyfill的区别</li>
</ul>
<h1 id="五、框架综合应用"><a href="#五、框架综合应用" class="headerlink" title="五、框架综合应用"></a>五、框架综合应用</h1><ul>
<li>基于React设计一个todolISt (组件结构，redux state 数据结构）</li>
<li>基于Vue设计一个购物车（组件结构，vuex state 数据结构)</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/vue3/" rel="tag"># vue3</a>
              <a href="/tags/React/" rel="tag"># React</a>
              <a href="/tags/webpack/" rel="tag"># webpack</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/07/21/Index/%E9%9D%A2%E8%AF%95%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86/" rel="prev" title="前端面试内容梳理">
      <i class="fa fa-chevron-left"></i> 前端面试内容梳理
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/11/05/Vue/Echarts/" rel="next" title="ECharts在vue2中的使用">
      ECharts在vue2中的使用 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一、Vue"><span class="nav-text">一、Vue</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue使用"><span class="nav-text">Vue使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Vue基础知识点"><span class="nav-text">Vue基础知识点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vue组件使用"><span class="nav-text">Vue组件使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#组件间通讯"><span class="nav-text">组件间通讯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#组件生命周期"><span class="nav-text">组件生命周期</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vue高级特性（重点）"><span class="nav-text">Vue高级特性（重点）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#自定义v-model"><span class="nav-text">自定义v-model</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nextTick"><span class="nav-text">$nextTick</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#slot"><span class="nav-text">slot</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#动态、异步组件"><span class="nav-text">动态、异步组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#keep-alive"><span class="nav-text">keep-alive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mixin（混入）"><span class="nav-text">mixin（混入）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vuex-待完成"><span class="nav-text">Vuex 待完成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vue-router"><span class="nav-text">Vue-router</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue原理"><span class="nav-text">Vue原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#组件化"><span class="nav-text">组件化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#数据驱动视图"><span class="nav-text">数据驱动视图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Vue中的MVVM"><span class="nav-text">Vue中的MVVM</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#响应式"><span class="nav-text">响应式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#虚拟DOM和diff"><span class="nav-text">虚拟DOM和diff</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#虚拟DOM"><span class="nav-text">虚拟DOM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#diff算法"><span class="nav-text">diff算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模板编译"><span class="nav-text">模板编译</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#with语法"><span class="nav-text">with语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#理解模板编译"><span class="nav-text">理解模板编译</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#vue中的模板编译"><span class="nav-text">vue中的模板编译</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#渲染过程"><span class="nav-text">渲染过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前端路由"><span class="nav-text">前端路由</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#hash模式"><span class="nav-text">hash模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#H5-history"><span class="nav-text">H5 history</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面试题汇总"><span class="nav-text">面试题汇总</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、Vue3"><span class="nav-text">二、Vue3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue3优势"><span class="nav-text">Vue3优势</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue3生命周期"><span class="nav-text">Vue3生命周期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Composition-API和Options-API"><span class="nav-text">Composition API和Options API</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ref、toRef、toRefs"><span class="nav-text">ref、toRef、toRefs</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ref"><span class="nav-text">ref</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#toRef"><span class="nav-text">toRef</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#toRefs"><span class="nav-text">toRefs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#最佳使用方式"><span class="nav-text">最佳使用方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#进阶，深入理解"><span class="nav-text">进阶，深入理解</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue3升级"><span class="nav-text">Vue3升级</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#createApp"><span class="nav-text">createApp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#emits属性"><span class="nav-text">emits属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多事件"><span class="nav-text">多事件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Fragment"><span class="nav-text">Fragment</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#v-model代替-sync"><span class="nav-text">v-model代替.sync</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#异步组件"><span class="nav-text">异步组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#移除filter"><span class="nav-text">移除filter</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Teleport"><span class="nav-text">Teleport</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Suspense"><span class="nav-text">Suspense</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Composition-API"><span class="nav-text">Composition API</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Composition-API逻辑复用"><span class="nav-text">Composition API逻辑复用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue3响应式"><span class="nav-text">Vue3响应式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Proxy基本使用"><span class="nav-text">Proxy基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Proxy实现响应式"><span class="nav-text">Proxy实现响应式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#watch-和watchEffect"><span class="nav-text">watch 和watchEffect</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#setup获取实例"><span class="nav-text">setup获取实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue3为何比-Vue2快"><span class="nav-text">Vue3为何比 Vue2快</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Proxy响应式"><span class="nav-text">Proxy响应式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PatchFlag"><span class="nav-text">PatchFlag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hoistStatic"><span class="nav-text">hoistStatic</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#cacheHandler"><span class="nav-text">cacheHandler</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tree-shaking"><span class="nav-text">tree-shaking</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSR-优化"><span class="nav-text">SSR 优化</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vite"><span class="nav-text">Vite</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ES6-module"><span class="nav-text">ES6 module</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Composition-API和React-Hooks"><span class="nav-text">Composition API和React Hooks</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、React"><span class="nav-text">三、React</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#React使用"><span class="nav-text">React使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#React基础知识点"><span class="nav-text">React基础知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JSX基本使用"><span class="nav-text">JSX基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#事件"><span class="nav-text">事件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#表单"><span class="nav-text">表单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#组件使用"><span class="nav-text">组件使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#setState"><span class="nav-text">setState</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#生命周期"><span class="nav-text">生命周期</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React高级特性"><span class="nav-text">React高级特性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#函数组件"><span class="nav-text">函数组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#非受控组件"><span class="nav-text">非受控组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Portals"><span class="nav-text">Portals</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#context"><span class="nav-text">context</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#异步组件-1"><span class="nav-text">异步组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#高阶组件HOC"><span class="nav-text">高阶组件HOC</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Render-Props"><span class="nav-text">Render Props</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React性能优化"><span class="nav-text">React性能优化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#shouldComponentUpdate-简称SCU"><span class="nav-text">shouldComponentUpdate (简称SCU )</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PureComponent和React-memo"><span class="nav-text">PureComponent和React.memo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#不可变值immutable-js"><span class="nav-text">不可变值immutable.js</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redux"><span class="nav-text">Redux</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本概念"><span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#单项数据流"><span class="nav-text">单项数据流</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#react-redux"><span class="nav-text">react- redux</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React-router"><span class="nav-text">React-router</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四、webpack"><span class="nav-text">四、webpack</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五、框架综合应用"><span class="nav-text">五、框架综合应用</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Chuckie"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Chuckie</p>
  <div class="site-description" itemprop="description">Bright future</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">116</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">57</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">100</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ChuckieWill" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ChuckieWill" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/codewyj.163.com" title="E-Mail → codewyj.163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.jianshu.com/u/de627226656c" title="https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;de627226656c" rel="noopener" target="_blank">简书</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2020 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="/images/me.png"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chuckie</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1.1m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">17:04</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
